/*! For license information please see 233.5d74abc9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk_bpinc_web_supervision_ui=self.webpackChunk_bpinc_web_supervision_ui||[]).push([[233],{3233:(e,t,n)=>{n.d(t,{fC:()=>O,Ui:()=>mt,PR:()=>ao});var r=n(2322),o=n(6029),i=n.n(o),a=n(7505),l=n(9717),s=n(9486),u=n(3194),c=n(9008);function d(e,t){var n,r=(0,u.useInteractionStateMethods)().qmStartCall,i=(0,u.useInteractionStateMethods)().disconnectItem,a=(0,c.useSessionState)(["privileges","userId","phoneNumber"]),l=a.privileges,s=a.userId,d=a.phoneNumber,f=(0,u.useInteractionStateSelector)((function(e){return e.items.find((function(e){var n;return(null===(n=e.scenarioData)||void 0===n?void 0:n.qmMonitoredItemId)===t}))})),m=null==f||null===(n=f.scenarioData)||void 0===n?void 0:n.qmMonitorMode,p=e===s,b=d||"",y=!!!l.SYS_MONITOR_INTERACTIONS||p,g=(0,o.useCallback)((function(e){return function(){m!==e&&(f&&i(f.id),r({mode:e,itemId:t,extension:b}))}}),[i,b,t,m,f,r]),h=(0,o.useMemo)((function(){return{disabled:y||"monitor"===m,start:g("monitor")}}),[y,g,m]),v=(0,o.useMemo)((function(){return{disabled:y||"whisper"===m,start:g("whisper")}}),[y,g,m]),S=(0,o.useMemo)((function(){return{disabled:y||"participate"===m,start:g("participate")}}),[y,g,m]);return(0,o.useMemo)((function(){return{monitor:h,whisper:v,participate:S}}),[h,S,v])}var f=n(6446),m=n(6441),p=function(e){var t=e.userId,n=(0,s.useLocalizationState)().t,i=(0,f.useStatsState)("keepMonitoredUsers"),a=(0,f.useStatsStateMethods)(),l=a.addKeepMonitoringUser,u=a.removeKeepMonitoringUser,d=(0,c.useSessionState)("userId"),p=t===d,b=i.some((function(e){return e===t})),y=(0,o.useCallback)((function(e){e?l(t):u(t)}),[l,u,t]);return(0,r.jsx)(m.Checkbox,{checked:b,onChange:y,disabled:p,className:"[&>input]:block",label:n.SUPERVISION_PAGE.quality_management_monitor_keep_monitoring()})},b=n(8269),y=n(4778),g=function(e){var t=e.userId,n=e.itemId,i=(0,s.useLocalizationState)().t,a=(0,f.useStatsStateMethods)().pullAgentScreen,u=(0,o.useCallback)((function(){(0,y.assertDefined)(t),(0,y.assertDefined)(n),a({userId:t,interactionId:n})}),[n,a,t]),c=(0,l.useOnKeyPressHandler)(u);return(0,r.jsx)(m.SemanticButton,{onClick:u,onKeyDown:c,tooltip:i.CALL_DETAILS_FORM.interaction_pullScreen_tooltip(),basic:!0,icon:!0,disabled:!t||!n,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconScreenPull,{})})},h=n(7421),v=n(801),S=function(e){var t=e.userId,n=(0,s.useLocalizationState)().t,i=(0,v.useOpenInfoModal)(),a=(0,h.useBpClientState)("version"),u=(0,f.useStatsStateMethods)().seeAgentScreen,c=(0,o.useCallback)((function(){if(!a)return i({body:n.CALL_DETAILS_FORM.interaction_seeScreen_helper_required_message()});(0,y.assertDefined)(t),u(t)}),[a,i,u,n.CALL_DETAILS_FORM,t]),d=(0,l.useOnKeyPressHandler)(c);return(0,r.jsx)(m.SemanticButton,{onClick:c,onKeyDown:d,tooltip:n.CALL_DETAILS_FORM.interaction_seeScreen_tooltip(),basic:!0,icon:!0,className:"flex !h-8 !w-8 items-center justify-center !p-0",disabled:!t,children:(0,r.jsx)(b.IconScreenSee,{})})},O=function(e){var t=e.userId,n=e.itemId,o=(0,s.useLocalizationState)().t,i=d(t,n),u=i.monitor,c=i.whisper,f=i.participate,m=(0,l.useOnKeyPressHandler)(u.start),b=(0,l.useOnKeyPressHandler)(c.start),y=(0,l.useOnKeyPressHandler)(f.start);return(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"mb-2 flex",children:[(0,r.jsxs)(a.SmMenu,{compact:!0,className:"!mr-2 !shadow-none",size:"mini",children:[(0,r.jsx)(a.SmMenu.Item,{as:"button",active:u.disabled,onClick:u.start,onKeyDown:m,className:"!h-[30px] !text-base",title:o.SUPERVISION_PAGE.quality_management_monitor_button(),children:o.SUPERVISION_PAGE.quality_management_monitor_button()}),(0,r.jsx)(a.SmMenu.Item,{as:"button",active:c.disabled,onClick:c.start,onKeyDown:b,className:"!h-[30px] !text-base",title:o.SUPERVISION_PAGE.quality_management_monitor_menu_coach(),children:o.SUPERVISION_PAGE.quality_management_monitor_menu_coach()}),(0,r.jsx)(a.SmMenu.Item,{as:"button",active:f.disabled,onClick:f.start,onKeyDown:y,className:"!h-[30px] !text-base",title:o.SUPERVISION_PAGE.quality_management_monitor_menu_barge_in(),children:o.SUPERVISION_PAGE.quality_management_monitor_menu_barge_in()})]}),(0,r.jsx)(g,{userId:t,itemId:n}),(0,r.jsx)(S,{userId:t})]}),(0,r.jsx)(p,{userId:t})]})},j=n(6607),_=n(4264),x=n(2122),I=n(7282),w=n(4483),C=n(8770),N=n(9327),P=n(3711),E=function(e){var t=e.user,n=(0,C.useGetAvatarUrl)();if(!t)return(0,r.jsx)(a.SmPlaceholder,{className:"h-[58px] w-[58px] rounded-full",children:(0,r.jsx)(a.SmPlaceholder.Image,{})});var o=(0,N.getUserStatusIcon)(t),i="available"===t.presenceState,l=n({userId:t.userId});return(0,r.jsx)(P.AvatarLegacy,{size:58,url:l,firstName:t.firstName,lastName:t.lastName,onlineStatus:o,online:i,type:"user"})},A=function(e){var t=e.onClose,n=(0,_.useSupervisionUIContextProducer)(),i=(0,_.useSupervisionUIContext)(["qmViewType","qmWidth","qmFloatingState","mainContentNode","qmModalClose"]),a=i.qmViewType,s=i.qmWidth,u=i.qmFloatingState,c=i.mainContentNode,d=i.qmModalClose,f=(0,m.useCanPin)({mainContentNode:c,floatingState:u,floatingSize:s,contentMinWidth:j.MAIN_CONTENT_MIN_WIDTH}),p=(0,o.useCallback)((function(e){null==d||d(),n((function(t){t.qmViewType=e}))}),[n,d]),y=(0,o.useCallback)((function(){null==d||d(),p("docked")}),[d,p]),g=(0,o.useCallback)((function(){p("floating")}),[p]),h=(0,o.useCallback)((function(){null==d||d(),p("overlay")}),[d,p]);(0,o.useEffect)((function(){f||"docked"!==a||p("overlay")}),[f,u,p,a]);var v=(0,l.useOnKeyPressHandler)(h),S=(0,l.useOnKeyPressHandler)(y),O=(0,l.useOnKeyPressHandler)(g),x=(0,l.useOnKeyPressHandler)(t);return(0,r.jsxs)("div",{className:"absolute right-4 top-0 flex",children:["docked"===a?(0,r.jsx)(m.SemanticButton,{icon:!0,transparent:!0,tabIndex:0,onClick:h,onKeyDown:v,children:(0,r.jsx)(b.IconUnpin,{})}):(0,r.jsx)(m.SemanticButton,{icon:!0,transparent:!0,onClick:y,onKeyDown:S,disabled:!f,children:(0,r.jsx)(b.IconPin,{})}),"floating"===a?(0,r.jsx)(m.SemanticButton,{icon:!0,transparent:!0,tabIndex:0,onKeyDown:v,onClick:h,children:(0,r.jsx)(b.IconPanelSide,{})}):(0,r.jsx)(m.SemanticButton,{icon:!0,transparent:!0,onClick:g,onKeyDown:O,children:(0,r.jsx)(b.IconPanelFloating,{})}),(0,r.jsx)(m.SemanticButton,{icon:!0,transparent:!0,onClick:t,onKeyDown:x,children:(0,r.jsx)(b.IconClose,{})})]})},k=n(5319),M=n(5928),T=n(533),D=function(e){var t=e.user,n=e.onActionStart,i=(0,s.useLocalizationState)().t,a=(0,c.useSessionState)("userId"),d=(0,u.useInteractionStateMethods)().initiateCall,f=(0,M.useServiceState)().selectedService,p=(0,T.useServicesDispositionsState)("serviceRequiredForOutboundCall"),y=(0,k.useDIDNumberState)().selectedDIDNumber,g=(0,v.useOpenInfoModal)(),h=t||{},S=h.userId,O=h.extension,j=S===a,_=(0,o.useCallback)((function(){if(p&&!f)return g({body:i.ERROR_MESSAGES.service_is_required_for_outbound_call_message()});O&&(d({phone:O,serviceId:f,accessNumberId:y}),n())}),[d,n,g,y,f,p,i.ERROR_MESSAGES,O]),x=(0,l.useOnKeyPressHandler)(_);return(0,r.jsx)(m.SemanticButton,{onClick:_,onKeyDown:x,tooltip:i.GLOBAL.call(),disabled:j||!O||!t,basic:!0,icon:!0,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconCallStroke,{className:"flex justify-center"})})},L=n(3346),R=function(e){var t=e.user,n=(0,s.useLocalizationState)().t,i=(0,f.useStatsStateMethods)(),a=i.setAgentState,u=i.logoutAgent,d=(0,c.useSessionState)(["userId","privileges"]),p=d.userId,g=d.privileges,h=(0,L.useModalsStateMethods)().openModal,v=(0,l.useBoolean)(),S=v.value,O=v.toggle,j=t||{},_=j.userId,x=j.acdState,I=j.isLogged,w=_===p,C=(0,o.useMemo)((function(){return(0,y.truthy)(["ready"!==x&&I?{children:n.MONITORING_CONFIRMATIONS.agentForceReady_title(),onClick:function(){O(),h({className:"autoSizeModal",title:n.MONITORING_CONFIRMATIONS.agentForceReady_confirm_heading(),body:n.MONITORING_CONFIRMATIONS.agentForceReady_confirm_msg(),actions:{ok:{title:n.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk(),action:function(){_&&a(_,"ready")}},cancel:{title:n.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}}})}}:void 0,{children:n.MONITORING_CONFIRMATIONS.agentForceLogout_title(),onClick:function(){O(),h({className:"autoSizeModal",title:n.MONITORING_CONFIRMATIONS.agentForceLogout_confirm_heading(),body:n.MONITORING_CONFIRMATIONS.agentForceLogout_confirm_msg(),actions:{ok:{title:n.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk(),action:function(){_&&u(_),O()}},cancel:{title:n.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}}})}}])}),[x,I,u,h,a,n.MONITORING_CONFIRMATIONS,n.WINDOW_POPUP_TITLES_AND_MESSAGES,O,_]);return(0,r.jsx)(m.PopupButton,{show:S,toggleShow:O,options:C,tooltip:n.MONITORING_CONFIRMATIONS.agentForceButton_tooltip(),disabled:w||!g.SYS_FORCE_STATE_OF_OTHER_AGENTS||!I||!t,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconCheckCircle,{})})},U=function(e){var t=e.user,n=e.onActionStart,i=(0,s.useLocalizationState)().t,a=(0,c.useSessionState)("userId"),d=(0,u.useInteractionStateMethods)().createPotentialItem,f=t||{},p=f.userId,g=f.firstName,h=f.lastName,v=f.extension,S=p===a,O=(0,o.useCallback)((function(){(0,y.assertTrue)(!S,"Cannot chat with self"),(0,y.assertDefined)(p),d({userId:p,firstName:g,lastName:h,phone:v}),n()}),[S,p,d,g,h,v,n]),j=(0,l.useOnKeyPressHandler)(O);return(0,r.jsx)(m.SemanticButton,{onClick:O,onKeyDown:j,tooltip:i.GLOBAL.chat(),disabled:S||!t,basic:!0,icon:!0,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconChatStroke,{})})},G=n(8445),F=function(e){var t=e.userId,n=e.onActionStart,i=(0,s.useLocalizationState)().t,a=(0,G.useNavigationState)("goTo"),u=(0,o.useCallback)((function(){a(G.AppRoutes.calendar,{userId:t}),n()}),[a,t,n]),c=(0,l.useOnKeyPressHandler)(u);return(0,r.jsx)(m.SemanticButton,{onKeyDown:c,onClick:u,tooltip:i.CALENDAR.calendar_button_tooltip(),disabled:!t,basic:!0,icon:!0,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconCalendar,{className:"flex justify-center"})})},B=function(){var e=(0,s.useLocalizationState)().t,t=(0,o.useCallback)((function(){}),[]),n=(0,l.useOnKeyPressHandler)(t);return(0,r.jsx)(m.SemanticButton,{onClick:t,onKeyDown:n,tooltip:e.EMAIL.emailPersonalQueue_header(),basic:!0,icon:!0,className:"flex !h-8 !w-8 items-center justify-center !p-0",children:(0,r.jsx)(b.IconCaseQueue,{})})},V=function(e){var t=e.onActionStart,n=e.user;return(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(D,{user:n,onActionStart:t}),(0,r.jsx)(U,{user:n,onActionStart:t})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(g,{userId:null==n?void 0:n.userId,itemId:null==n?void 0:n.activeItemId}),(0,r.jsx)(S,{userId:null==n?void 0:n.userId})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(F,{userId:null==n?void 0:n.userId,onActionStart:t}),(0,r.jsx)(B,{user:n,onActionStart:t}),(0,r.jsx)(R,{user:n})]})]})},q=n(9464),z=n(7043),H=n(7194),W=n(3431),K=n(5341),$=n(1362),Q=function(){var e=(0,s.useLocalizationState)().t,t=(0,H.useAgentStateOptions)(),n=(0,o.useMemo)((function(){return(0,H.createAgentStateOptionSelector)()}),[]),r=(0,o.useCallback)((function(e){var r=e.acdState,o=e.reason;if((0,W.isAcdState)(r))return n({state:r,notReadyReason:o},t)}),[t,n]),i=(0,o.useCallback)((function(e){var t,n,o=(0,K.getMonitoringUserActiveItem)(e),i=null!==(t=null==o?void 0:o.media_type)&&void 0!==t?t:"",a=null!==(n=null==o?void 0:o.direction)&&void 0!==n?n:"",l=r({acdState:e.acd_state,reason:e.reason}),s=(0,$.convertKVArray)(e.items||{}).find((function(e){return"queued"===e.state||"IVR"===e.state})),u="busy"===(null==l?void 0:l.state)||"after_call_work"===(null==l?void 0:l.state)||Boolean(null==s?void 0:s.item_id);return[{agentStatusOption:l,busyMediaType:(0,q.isMediaType)(i)?i:void 0,direction:(0,q.isItemDirection)(a)?a:void 0},u?{agentStatusOption:r({acdState:e.acd_next_state,reason:e.next_reason})}:void 0]}),[r]),a=(0,o.useCallback)((function(t){if("1"!==t.is_logged)return"";var n=r({acdState:t.acd_state,reason:t.reason});if(n){if(n.localizeId){var o,i,a=n.localizeId,l=null===(o=(i=e.AGENT_STATE_CONTROL)[a])||void 0===o?void 0:o.call(i,n.state);if(l)return l}return n.label}return t.reason}),[r,e]);return(0,o.useMemo)((function(){return{getAgentStateOption:r,getAgentStateIconsProps:i,getAgentStateTitle:a}}),[i,a,r])};function Y(){var e=(0,s.useLocalizationState)("t").SUPERVISION_PAGE;return(0,o.useCallback)((function(t){if(!t||t.customName)return(null==t?void 0:t.customName)||"";switch(t.id){case"_group_state":return e.users_table_group_state();case"_group_states_daily":return e.users_table_group_states_daily();case"_group_out_daily":return e.users_table_group_out_daily();case"_group_in_daily":return e.users_table_group_in_daily();case"_group_in_email_daily":return e.users_table_group_in_email_daily();case"_group_surveys_daily":return e.users_table_group_surveys_daily();case"_group_records_daily":return e.users_table_group_records_daily();case"_group_remainders":return e.users_table_group_remainders()}return""}),[e])}var Z=n(4690),J=function(e){var t=e.user,n=(0,f.useStatsState)((function(e){var n=(0,$.convertKVArray)(t.items||{},(function(e){return{itemId:e.item_id,intents:Object.keys(e.intents||{})}}));return e.intentAlerts.filter((function(e){return!e.closed&&e.userId==t.user_id&&n.some((function(t){return t.itemId===e.itemId&&t.intents.includes(e.intentId)}))}))[0]}));return n?(0,r.jsx)(m.Popup,{mode:"hover",hoverable:!0,placement:"top-start",content:(0,r.jsx)("div",{role:"alert",children:(0,r.jsxs)("div",{className:"flex justify-between gap-2 text-sm",children:[(0,r.jsx)("div",{className:"font-bold",children:n.agentName}),(0,r.jsx)("div",{children:n.customerName}),(0,r.jsx)("div",{className:"text-icon",children:(0,l.timeFromNow)(n.timestamp)})]})}),children:(0,r.jsx)(b.IconAlert,{})}):null},X=n(3650),ee=function(e){var t=e.row,n=e.column,o=e.renderValue;if("string"!=typeof t.id)throw new Error("item.id must be a string");var i=t[n.name],a="string"==typeof i?i:void 0,l=(0,X.useLiveStatTimer)(a);return(0,r.jsx)(r.Fragment,{children:o(l,n.name,t)})};function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){te(e,t,n[t])}))}return e}var re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customRenderer,n=e.search,i=(0,s.useLocalizationState)().t,a=(0,I.useFormatting)().formatFullName,u=(0,o.useDeferredValue)(n),c=Q().getAgentStateTitle,d=(0,f.useStatsState)(["thresholds","systemThresholds"]),p=d.thresholds,b=d.systemThresholds,y=(0,o.useMemo)((function(){return ne({},b.config,p.config)}),[b,p]),g=(0,o.useCallback)((function(e,t,n){if("string"==typeof e||"number"==typeof e){var r=(0,Z.isThresholdKey)(t)&&y[t];if(r){var o=r.condition,i={color:r.textColor,backgroundColor:r.backgroundColor};switch(o){case"GREAT_THAN":return Number(e)>Number(r.value)?i:void 0;case"LESS_THAN":return Number(e)<Number(r.value)?i:void 0;case"AUTO":return n?i:void 0;default:return}}}}),[y]),h=(0,o.useCallback)((function(e){if("string"==typeof e||"number"==typeof e){var t=(0,l.formatDurationShort)(e);return(0,m.highlighted)({text:t,highlight:u})}}),[u]),v=(0,o.useCallback)((function(e){var t=e.service_level,n=e.service_level_target,o=e.service_level_threshold_time;if(!("string"!=typeof t&&"number"!=typeof t||"string"!=typeof n&&"number"!=typeof n||"string"!=typeof o&&"number"!=typeof o))return(0,r.jsxs)(r.Fragment,{children:[t,(n||o)&&(0,r.jsx)("span",{className:"ml-1 text-main",children:"(".concat(n,"/").concat(o,")")})]})}),[]),S=(0,o.useCallback)((function(e,t){return void 0!==e[t.name]&&(0,r.jsx)(m.SentimentSlider,{value:Number(e[t.name])})}),[]),O=(0,o.useCallback)((function(e){if("string"==typeof e||"number"==typeof e)return(0,m.highlighted)({text:"".concat(e),highlight:u})}),[u]);return(0,o.useCallback)((function(e,n){var o=e[n.name];switch(n.name){case"name":default:return{value:O(o),meta:g(o,n.name)};case"display_name":var l=a(String(e.firstname),String(e.lastname));return e.reason&&(l+=" (".concat(e.reason,")")),{value:(0,m.highlighted)({text:l,highlight:u}),meta:void 0};case"agent_preview_duration":case"login_time":case"active_item_talk_duration":case"active_item_hold_duration":return{value:(0,r.jsx)(ee,{row:e,column:n,renderValue:h}),meta:g(o,n.name)};case"state_duration":var s=function(){switch(e.acd_state){case"ready":return"ready_state";case"after_call_work":return"wrap_up_time";case"not_ready":return"string"==typeof e.reason&&(0,Z.getNotReadyKey)(e.reason);default:return}}();return{value:(0,r.jsx)(ee,{row:e,column:n,renderValue:h}),meta:s?g(o,s):void 0};case"agent_average_idle_time":case"agent_average_preview_time":case"agent_idle_time":case"agent_total_acw_time":case"agent_total_break_time":case"agent_total_busy_time":case"agent_total_ready_time":case"agent_total_not_ready_time":case"calls_average_acw_time_per_day":case"calls_average_handling_time_per_day":case"in_calls_duration_average_per_day":case"in_calls_duration_total_per_day":case"in_calls_dropped_talking_per_day":case"in_calls_disconnected_talking_per_day":case"in_ewt":case"in_max_wait_time":case"out_calls_duration_average_per_day":case"out_calls_duration_total_per_day":return{value:h(e[n.name]),meta:g(o,n.name)};case"active_item_qm_is_recording":return{value:"1"===e[n.name]?i.MONITORING_AGENTS_COLUMN_NAMES.monitoring_recording_value_yes():i.MONITORING_AGENTS_COLUMN_NAMES.monitoring_recording_value_no(),meta:void 0};case"agent_current_number_interactions":return{value:~~Number(e[n.name]),meta:void 0};case"service_level":var d=e.service_level,f=e.service_level_target;return{value:v(e),meta:g(o,n.name,!!d&&!!f&&Number(d)<Number(f))};case"active_item_sentiment":return{value:S(e,n),meta:g(o,n.name)};case"state_text":return{value:(0,m.highlighted)({text:c(e),highlight:u}),meta:g(o,n.name)};case"last_alert":return{value:(0,r.jsx)(J,{user:e}),meta:void 0};case"custom:checkbox":case"custom:status":case"custom:interactions":return{value:t?t(e,n):null,meta:void 0}}}),[t,a,c,g,O,S,v,h,u,i.MONITORING_AGENTS_COLUMN_NAMES])};function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||ue(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ue(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){if(e){if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}var ce=function(e){var t=e.config,n=e.getColumnTitle,r=e.sortingSettings,i=e.setSortingSettings,a=e.extraColumns,l=e.scrollEnabled,s=void 0!==l&&l,u=e.collapsedGroupIds,c=Object.entries(u||{}).filter((function(e){var t=le(e,2);t[0];return t[1]})).map((function(e){var n,r=le(e,1)[0];return null===(n=(t||[]).find((function(e){return e.parentId===r&&e.v})))||void 0===n?void 0:n.id}));return(0,o.useMemo)((function(){var e=function(e){var t=s?e.sW:e.w,r=e.id;return{name:r,title:e.customName||n(r),width:t,groupId:e.parentId,align:de(r)}},o=(t||[]).filter((function(e){var t=e.v,n=null==a?void 0:a.some((function(t){return t.name===e.id&&t.sticky})),r=!!(u&&e.parentId&&u[e.parentId])&&!c.includes(e.id);return t&&!n&&!r})).map(e);if(!r){var l=(0,m.getDefaultSortingSettings)(o);l&&i(l)}var d,f=null==a?void 0:a.filter((function(e){return e.sticky}));(null==f?void 0:f.length)&&(d=o).unshift.apply(d,se(f.map((function(n){var r=null==t?void 0:t.find((function(e){return e.id==n.name}));if(!r)return n;var o=e(r);return ae(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ie(e,t,n[t])}))}return e}({},n),{width:n.width||(null==o?void 0:o.width),align:n.align||(null==o?void 0:o.align),title:n.title||(null==o?void 0:o.title)||"",hidden:void 0===n.hidden?null==o?void 0:o.hidden:n.hidden,resizable:void 0===n.resizable||n.resizable})}))));return o}),[t,r,a,u,c,i,s,n])};function de(e){return Z.alignedLeftColumns.includes(e)?"start":"end"}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e){return function(e){if(Array.isArray(e))return fe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){if(e){if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}var ye=function(e){var t=e.stats,n=e.sortingSettings,r=e.allItem,i=e.filter,a=(0,I.useFormatting)().formatFullName;return(0,o.useMemo)((function(){var e=pe(t);if(n){var o=n.column,l=n.sorting;e.sort((function(e,t){var n=me(function(e,t,n){return"display_name"===e?"string"!=typeof t.firstname||"string"!=typeof t.lastname||"string"!=typeof n.firstname||"string"!=typeof n.lastname?[0,0]:[a(t.firstname,t.lastname),a(n.firstname,n.lastname)]:[t[e],n[e]]}(o,e,t),2),r=n[0],i=n[1];return"number"==typeof r&&"number"==typeof i?"ASC"===l?r-i:i-r:"string"==typeof r&&"string"==typeof i?"ASC"===l?r.localeCompare(i):i.localeCompare(r):0}))}return r&&e.length>1&&e.unshift(r),i?e.filter(i):e}),[t,n,r,i,a])},ge=function(e){var t=(0,f.useStatsState)().monitoringTeamsStats,n=(0,s.useLocalizationState)().t;return(0,o.useMemo)((function(){var r;return""===e?n.GLOBAL.all_teams():(null===(r=Object.values(t).find((function(t){return t.team_id===e})))||void 0===r?void 0:r.name)||""}),[e,n.GLOBAL,t])},he=n(3830),ve=n.n(he),Se=n(6702),Oe=n(7176),je=n(3385),_e=n(4915),xe=n(4173);const Ie="supervision_QuickMonitor_mark_PLmW0",we="supervision_QuickMonitor_highlighted_HZ6xl";var Ce,Ne="intent_+".concat(CSS.escape((0,xe.uuid)()));function Pe(e,t){return(0,_e.highlightHTML)({html:e,textToHighlight:t,className:Ie})}function Ee(e,t){var n,r,i=(n=(0,s.useLocalizationState)().t,r=(0,I.useFormatting)().formatFullName,(0,o.useCallback)((function(e,t){var o=r(null==t?void 0:t.firstName,null==t?void 0:t.lastName);switch(e.systemType){case"party_connected":return n.SUPERVISION_PAGE.quality_management_monitor_party_connected(o);case"party_inviting":return n.SUPERVISION_PAGE.quality_management_monitor_party_inviting(o);case"party_left":return n.SUPERVISION_PAGE.quality_management_monitor_party_left(o)}return e.systemType}),[r,n.SUPERVISION_PAGE]));return(0,o.useMemo)((function(){return e.map((function(e){var n=e.id,r=e.partyId,o=e.timestamp,a=e.type,l=t[r],s=function(e){return"external"===(null==e?void 0:e.type)?"incoming":"outgoing"}(l);return{id:n,timestamp:o,htmlContent:"system"===e.type?i(e,l):(0,je.normalizeByUrlParser)(e.text),party:l,type:a,direction:s}}))}),[i,e,t])}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ke(e,t,n[t])}))}return e}function Te(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Le=function(e){var t=e.children,n=e.parties,i=e.intents,a=e.autofocusedIntentAlert,s=e.messages,u=(0,_.useSupervisionUIContextProducer)(),c=De((0,o.useState)({search:"",searchResult:void 0,targetIntent:void 0}),2),d=c[0],f=c[1],m=(0,o.useMemo)((function(){return Object.values(n).filter((function(e){return"scenario"!==e.type&&(!e.isQm||"participate"===e.qmMode)})).length>2}),[n]),p=Ee(s,n),b=(0,l.useAsRef)(d),y=(0,o.useCallback)((function(e){var t=ve()(b.current,e);f((function(e){return Me({},e,t)}))}),[b]);(0,o.useEffect)((function(){if(a&&p.length&&i.length){var e=i.find((function(e){return e.id===a.intentId}));if(!e)return;var t=p.findIndex((function(t){return t.id===e.msgId}));y((function(n){n.targetIntent={messageIndex:t,intentText:e.text,messageId:e.msgId}})),u((function(e){e.qmAutofocusedIntentAlert=void 0}))}}),[a,i,p,y,u]);var g=(0,l.useAsRef)(Te(Me({},d),{messages:p,isConference:m,intents:i})),h=(0,o.useMemo)((function(){return{state:Te(Me({},d),{messages:p,isConference:m,intents:i}),produceState:y,stateRef:g}}),[d,p,m,i,y,g]);return Ce||((Ce=(0,Se.createContext)(h)).displayName="QuickMonitorContext"),(0,r.jsx)(Ce.Provider,{value:h,children:t})},Re=(0,Oe.createUIStateHooks)("QuickMonitorContext",(function(){return Ce})),Ue=Re.useQuickMonitorContext,Ge=Re.useQuickMonitorContextProducer,Fe=function(){var e=Ue(["intents","messages"]),t=e.intents,n=e.messages,o=Ge();return t.length?(0,r.jsx)("div",{className:"mx-4 mt-2 max-h-[62px] shrink-0 overflow-y-auto rounded border border-main-border p-1",children:t.map((function(e){return(0,r.jsx)(m.SemanticButton,{onClick:function(){var t=n.findIndex((function(t){return t.id===e.msgId}));o((function(n){n.targetIntent={messageIndex:t,intentText:e.text,messageId:e.msgId}}))},basic:!0,className:"!mx-1 !my-0.5 !rounded-[16px] !px-3 !py-0.5 !leading-[17px]",children:(0,r.jsx)("span",{className:"text-primary-legacy",children:e.name})},e.msgId)}))}):null},Be=n(9552),Ve=function(e){var t=e.direction,n=e.children,o="incoming"===t;return(0,r.jsx)("div",{className:(0,w.B)("flex flex-col pb-2 ",{"items-end":!o,"items-start":o}),children:n})},qe=n(6622);function ze(e,t){var n=e.htmlContent,r=e.id,i=Ue(["searchResult","search","targetIntent"]),a=i.searchResult,s=i.search,u=i.targetIntent,c=(0,o.useRef)(!1),d=(0,o.useRef)(!1),f=(0,o.useMemo)((function(){var e,t,o=Pe(n,s);return(null==u?void 0:u.messageId)!==r?o:(e=o,t=u.intentText,(0,_e.highlightHTML)({html:e,textToHighlight:t,element:"span",className:Ne}))}),[n,s,null==u?void 0:u.messageId,null==u?void 0:u.intentText,r]),m=(0,l.useInnerHTML)(f);(0,o.useEffect)((function(){if(t.current&&(null==a?void 0:a.messageId)===r){var e,n,o,i=(e=t.current,n=a.index,null===(o=e.querySelectorAll(".".concat(Ie)))||void 0===o?void 0:o[n]);if(i)return i.classList.add(we),i.scrollIntoView({block:"center"}),d.current=!0,function(){return i.classList.remove(we)}}}),[r,t,a]),(0,o.useEffect)((function(){if(t.current&&(null==u?void 0:u.messageId)===r&&!c.current){var e=t.current.querySelector(".".concat(Ne));e&&(e.scrollIntoView({block:"center"}),c.current=!0)}}),[r,t,a,null==u?void 0:u.messageId]);var p=(0,l.useValueUpdated)(a);(0,o.useEffect)((function(){p&&(d.current=!1)}),[u,p]);var b=(0,l.useValueUpdated)(u);return(0,o.useEffect)((function(){b&&(c.current=!1)}),[u,b]),m}var He=function(e){var t,n,i=e.message,a=(0,o.useRef)(null),l=(0,I.useFormatting)().formatFullName,s="incoming"===i.direction,u=l(null===(t=i.party)||void 0===t?void 0:t.firstName,null===(n=i.party)||void 0===n?void 0:n.lastName),c=(0,qe.formatDate)(i.timestamp),d=ze(i,a);return(0,r.jsx)(m.Popup,{mode:"hover",className:"max-w-4/5",content:"".concat(u?u+", ":"").concat(c),children:(0,r.jsx)("div",{ref:a,dangerouslySetInnerHTML:d,className:(0,w.B)("inline-block whitespace-pre-line rounded",{"border border-chat-center-out-message-border px-1 py-[3px]":!s,"bg-chat-center-in-message-bg p-1":s})})})},We=function(e){var t=e.message,n=(0,o.useRef)(null),i=ze(t,n);return(0,r.jsxs)("div",{className:"m-0 flex items-center gap-1 text-main-secondary",children:[(0,r.jsx)(b.IconCogwheel,{}),(0,r.jsx)("p",{ref:n,dangerouslySetInnerHTML:i})]})},Ke=function(e){var t=e.message;switch(t.type){case"regular":return(0,r.jsx)(He,{message:t});case"scenario":case"system":return(0,r.jsx)(We,{message:t})}return(0,r.jsx)("p",{children:"Unknown message type"})},$e=function(e){var t,n,o=e.message,i=Ue("isConference"),a="incoming"===o.direction,l=(0,I.useFormatting)().formatFullName;if(!i||a||"regular"!==o.type)return null;var s=l(null===(t=o.party)||void 0===t?void 0:t.firstName,null===(n=o.party)||void 0===n?void 0:n.lastName);return(0,r.jsx)("p",{className:"mb-1 text-sm font-bold",children:s})},Qe=function(e){var t=e.message;return(0,r.jsxs)(Ve,{direction:t.direction,children:[(0,r.jsx)($e,{message:t}),(0,r.jsx)(Ke,{message:t})]})};function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Je=function(){var e=Ue(["messages","searchResult","targetIntent"]),t=e.messages,n=e.searchResult,i=e.targetIntent,a=(0,o.useRef)(null),s=(0,l.useBoolean)(),u=s.value,c=s.setTrue,d=s.setFalse,f=(0,l.useScrollObserver)({onScrollAppeared:c,onScrollDisappeared:d}),m=Ze((0,o.useState)(void 0),2),p=m[0],b=m[1],y=(0,o.useCallback)((function(e){b(e),f.current=e}),[f]);(0,o.useEffect)((function(){var e;(null==n?void 0:n.messageId)&&(null===(e=a.current)||void 0===e||e.scrollToIndex({index:n.messageIndex,align:"center"}))}),[n]),(0,o.useEffect)((function(){var e;i&&(null===(e=a.current)||void 0===e||e.scrollToIndex({index:i.messageIndex,align:"center"}))}),[i]);var g=(0,o.useCallback)((function(e,t){return(0,r.jsx)(Qe,{message:t})}),[]),h=(0,o.useCallback)((function(e,t){return t.id}),[]),v=(0,o.useMemo)((function(){return i?{index:i.messageIndex,align:"center"}:{index:"LAST"}}),[i]);return(0,r.jsx)("div",{className:"flex flex-1 flex-col overflow-hidden pr-1 pt-2",children:(0,r.jsx)("div",{ref:y,className:(0,w.B)("relative min-h-2.5 grow overflow-y-auto pl-4",{"pr-1":u,"pr-3":!u}),children:(0,r.jsx)(Be.Virtuoso,{tabIndex:void 0,ref:a,followOutput:!0,data:t,itemContent:g,computeItemKey:h,customScrollParent:p,initialTopMostItemIndex:v})})})};function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||nt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e){return function(e){if(Array.isArray(e))return Xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||nt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){if(e){if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xe(e,t):void 0}}var rt=function(){var e=(0,s.useLocalizationState)().t,t=Ue(["messages","search"]),n=t.messages,i=t.search,a=Ge(),l=et((0,o.useState)(""),2),u=l[0],c=l[1],d=et((0,o.useState)(void 0),2),f=d[0],p=d[1],b=(0,o.useMemo)((function(){return(0,x.debounce)((function(e){a((function(t){t.search=e}))}),500)}),[a]);(0,o.useEffect)((function(){b(u)}),[u,b]);var y=(0,o.useMemo)((function(){return i?n.reduce((function(e,t,n){var r=Pe(t.htmlContent,i),o=(r.match(new RegExp((0,x.escapeRegExp)(Ie),"g"))||[]).length;return tt(Array.from({length:o}).map((function(e,r){return{messageId:t.id,messageIndex:n,index:r}})).reverse()).concat(tt(e))}),[]):[]}),[i,n]);(0,o.useEffect)((function(){if(f){var e=y[f-1];a((function(t){t.searchResult=e}))}else a((function(e){e.searchResult=void 0}))}),[y,f,a]);var g=(0,o.useCallback)((function(e){p(e)}),[]),h=(0,o.useCallback)((function(e){c(e.target.value),p(1)}),[]),v=(0,o.useCallback)((function(){c(""),p(void 0)}),[]);return(0,r.jsxs)("div",{className:"flex gap-2 px-4",children:[(0,r.jsx)(m.SearchInput,{clearable:!0,value:u,onChange:h,onClear:v,enabledInOffline:!0,placeholder:e.SUPERVISION_PAGE.quality_management_monitor_search_transcript()}),!!u&&(0,r.jsx)(m.SearchResultsSwitcher,{current:f||0,total:y.length,onChange:g})]})};function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ot(e,t,n[t])}))}return e}function at(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var lt=function(e){var t,n,i,a,l=e.item,s=e.autofocusedIntentAlert;t=l.id,n=(0,f.useStatsStateMethods)(),i=n.subscribeToItemPeek,a=n.unsubscribeFromItemPeek,(0,o.useLayoutEffect)((function(){if(t)return i(t),function(){a(t)}}),[t,i,a]);var u=(0,f.useStatsState)((function(e){return e.peekItems[l.id||""]}));return u?u.isLoading?(0,r.jsx)("div",{className:"relative mt-2 flex flex-1 items-center justify-center p-8",children:(0,r.jsx)(m.Loader,{active:!0,color:"primary",size:"medium"})}):(0,r.jsx)("div",{className:"mt-2 flex flex-1 flex-col overflow-hidden",children:(0,r.jsxs)(Le,at(it({},u),{autofocusedIntentAlert:s,children:[(0,r.jsx)(rt,{}),(0,r.jsx)(Fe,{}),(0,r.jsx)(Je,{})]}))}):null},st=function(e){var t=e.item,n=e.user,i=e.agentStatusOption,a=(0,s.useLocalizationState)().t,u=(0,l.useBoolean)(),c=u.value,f=u.toggle,p=t.mediaType,y=t.direction,g=t.sentiment,h=void 0===g?0:g,v=(0,q.isMediaType)(p)?p:void 0,S=d(n.userId,t.id),O=S.monitor,j=S.whisper,_=S.participate,x=(0,o.useMemo)((function(){return[{children:a.SUPERVISION_PAGE.quality_management_monitor_menu_coach(),onClick:j.start,disabled:j.disabled},{children:a.SUPERVISION_PAGE.quality_management_monitor_menu_barge_in(),onClick:_.start,disabled:_.disabled}]}),[_.disabled,_.start,a.SUPERVISION_PAGE,j.disabled,j.start]);return(0,r.jsxs)("div",{className:(0,w.B)("mx-4 flex items-center justify-between gap-4 px-4 py-2.5","rounded border border-main-border",{"border-[--sentiment-slider-positive]":h>0,"border-[--sentiment-slider-negative]":h<0}),children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex flex-1 gap-4",children:[(0,r.jsx)("span",{className:"font-bold",children:t.partyName||a.GLOBAL.heading_unknown()}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(z.AgentStatusIcon,{isLoggedOut:!n.isLogged,agentStatusOption:i,busyMediaType:v,direction:y,className:"!h-5 !w-5"}),t.talkDuration&&(0,r.jsx)("span",{children:(0,l.formatDurationShort)(t.talkDuration)})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m.SentimentSlider,{value:h})})]}),(0,r.jsx)("div",{className:"mt-1.5 flex gap-4",children:t.serviceName&&(0,r.jsx)("span",{children:t.serviceName})})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(m.SemanticButton,{basic:!0,tooltip:a.SUPERVISION_PAGE.quality_management_monitor_button(),disabled:O.disabled,className:"!h-[30px] !px-2 !py-1.5",onClick:O.start,children:(0,r.jsx)("span",{className:"font-bold",children:a.SUPERVISION_PAGE.quality_management_monitor_button()})}),(0,r.jsx)(m.PopupButton,{show:c,toggleShow:f,options:x,tooltip:a.SUPERVISION_PAGE.quality_management_monitor_menu_button(),className:"!flex !h-[30px] !w-[30px] items-center justify-center !p-0",children:(0,r.jsx)(b.IconMore,{className:"h-4 w-4"})})]})]})};function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var dt=function(e){var t,n=e.user,i=(0,s.useLocalizationState)().t,a=Q().getAgentStateOption,l=n.items,u=n.activeItemId,d=(0,o.useMemo)((function(){return a({acdState:n.acdState,reason:n.reason})}),[a,n]),f=(0,c.useSessionState)("privileges"),p=(0,_.useSupervisionUIContext)("qmAutofocusedIntentAlert"),b=!!f.SYS_MONITOR_INTERACTIONS,y=(0,o.useMemo)((function(){return Object.entries(l||{}).reduce((function(e,t){var n=ct(t,2),r=(n[0],n[1]);return r&&e.push({id:r.id||"",title:r.partyName||"",item:r}),e}),[])}),[l]),g=ct((0,o.useState)(u||(null===(t=y[0])||void 0===t?void 0:t.id)||(null==p?void 0:p.itemId)||""),2),h=g[0],v=g[1];(0,o.useEffect)((function(){var e;y.some((function(e){return e.id===h}))||v((null===(e=y[0])||void 0===e?void 0:e.id)||"")}),[h,y]),(0,o.useEffect)((function(){if(p){var e=y.find((function(e){return e.id===p.itemId}));e&&v(e.id)}}),[p,y]);var S=(0,o.useCallback)((function(e){var t=e.id,n=e.item,o=e.title,a=n.mediaType,l=n.direction,s=(0,q.isMediaType)(a)?a:void 0,u=l&&(0,q.isItemDirection)(l)?l:void 0;return(0,r.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,r.jsx)(z.AgentStatusIcon,{agentStatusOption:d,busyMediaType:s,direction:u,className:"!h-4 !w-4"}),(0,r.jsx)("span",{className:(0,w.B)({"font-bold":t===h}),children:o||i.GLOBAL.heading_unknown()})]})}),[h,i.GLOBAL,d]),O=(0,o.useCallback)((function(e){var t=e.item;return(0,r.jsxs)("div",{className:"mt-2 flex flex-1 flex-col overflow-hidden",children:[(0,r.jsx)(st,{item:t,user:n,agentStatusOption:d}),b&&(0,r.jsx)(lt,{item:t,autofocusedIntentAlert:t.id===(null==p?void 0:p.itemId)?p:void 0})]},t.id)}),[n,d,b,p]);return(0,r.jsx)(m.Tabs,{tabs:y,activeTabId:h,renderTab:S,renderTabContent:O,onChange:v,className:"mt-5 flex flex-1 flex-col overflow-hidden",headerClassName:(0,w.B)("h-auto border-0 bg-transparent px-4"),tabClassName:(0,w.B)("px-2 pb-2 pt-0"),tabsContentClassName:"flex flex-1 flex-col overflow-hidden"})},ft=function(e){var t=e.userId,n=e.className,i=(0,s.useLocalizationState)().t,a=(0,I.useFormatting)().formatFullName,u=(0,_.useSupervisionUIContextProducer)(),c=(0,_.useSupervisionUIContext)(["qmViewType","qmShowDetails","qmModalClose"]),d=c.qmViewType,y=c.qmShowDetails,g=c.qmModalClose,h=(0,f.useStatsStateMethods)(),v=h.subscribeToUserDetails,S=h.unsubscribeFromUserDetails,O=(0,f.useStatsState)((function(e){return e.userDetails[t]}));(0,o.useEffect)((function(){return v([t]),function(){return S([t])}}),[v,S,t]);var j="floating"===d,C=j&&!(0,x.isEmpty)(null==O?void 0:O.items),N=(0,o.useCallback)((function(){null==g||g(),u((function(e){e.qmUserId=void 0}))}),[u,g]),P=(0,o.useCallback)((function(){u((function(e){e.qmShowDetails=!e.qmShowDetails}))}),[u]),k=(0,l.useOnKeyPressHandler)(P);return(0,r.jsxs)("div",{className:n,children:[(0,r.jsxs)("div",{className:"relative flex gap-[30px] px-4",children:[(0,r.jsx)(A,{onClose:N}),(0,r.jsx)(E,{user:O}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"mb-2 font-bold ",children:[a(null==O?void 0:O.firstName,null==O?void 0:O.lastName),(0,r.jsx)("br",{})]}),(0,r.jsx)(V,{onActionStart:N,user:O})]})]}),(0,r.jsxs)("div",{className:"mt-5 flex justify-between gap-8 px-4",children:[(0,r.jsx)(p,{userId:t}),C&&(0,r.jsx)(m.SemanticButton,{tabIndex:0,tooltip:i.SUPERVISION_PAGE.quality_management_monitor_show_details(),disabled:!O,transparent:!0,onClick:P,onKeyDown:k,children:(0,r.jsx)(b.IconChevronUpCircle,{className:(0,w.B)({"scale-y-[-1]":!y})})})]}),O&&(y||!j)&&(0,r.jsx)(dt,{user:O})]})},mt=function(){var e=(0,_.useSupervisionUIContext)(["qmUserId","qmWidth","qmFloatingState","mainContentNode","qmViewType"]),t=e.qmUserId,n=e.qmWidth,i=e.qmFloatingState,a=e.mainContentNode,l=e.qmViewType,s=(0,_.useSupervisionUIContextProducer)(),u=(0,o.useCallback)((function(e){s((function(t){t.qmWidth=e}))}),[s]),c=(0,o.useCallback)((function(e){var t="string"==typeof e?e:e(i);s((function(e){e.qmFloatingState=t}))}),[s,i]),d=(0,m.useCanPin)({mainContentNode:a,floatingState:i,floatingSize:n,contentMinWidth:j.MAIN_CONTENT_MIN_WIDTH}),f=(0,o.useCallback)((function(e){var t=e.size;u(t)}),[u]);return(0,r.jsx)(m.Floating,{canPin:d,exceptionSelectors:".".concat(j.SUPERVISION_USERS_TABLE," tbody tr"),initialSize:n,minSize:_.MIN_QM_WIDTH,onDragEnd:f,resizeable:!0,setState:c,side:"right",state:i,"data-testid":"qm-panel",showEar:!1,className:"flex h-full flex-col overflow-hidden",children:t&&"floating"!==l&&(0,r.jsx)(ft,{userId:t,className:"flex h-full flex-col py-2"})})},pt=n(2443),bt=n(9162),yt=n.n(bt);function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){gt(e,t,n[t])}))}return e}function vt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var St="QM_MODAL_HANDLE_"+(0,xe.uuid)(),Ot=i().memo((function(e){var t=e.position,n=e.onClose,i=(0,_.useSupervisionUIContextProducer)(),a=(0,_.useSupervisionUIContext)(["qmUserId","qmViewType","qmShowDetails","qmModalClose"]),s=a.qmUserId,u=a.qmShowDetails,c=a.qmModalClose,d=(0,f.useStatsState)((function(e){var t;return!(0,x.isEmpty)(null===(t=e.userDetails[s||""])||void 0===t?void 0:t.items)})),p=u&&d;(0,o.useEffect)((function(){return i((function(e){e.qmModalClose=function(){return n("end")}})),function(){i((function(e){e.qmModalClose=void 0}))}}),[n,i]);var b=(0,X.useDraggableModal)({modalType:"quality_management_monitor",position:t}),y=b.draggableNodeRef,g=b.draggableProps;return(0,l.useEscapeManager)((function(){null==c||c(),i((function(e){e.qmUserId=void 0}))})),s?(0,r.jsx)(m.FocusTrap,{children:(0,r.jsx)(yt(),vt(ht({},g),{handle:"#".concat(St),children:(0,r.jsxs)("div",{className:(0,w.B)("fixed left-[calc(50%-248px)] top-24 z-[100]","flex w-[496px] flex-col overflow-hidden","border border-[--c-main-bars-bg] bg-main-bg shadow",{"h-full max-h-[min(700px,80vh)] min-h-[max(500px,min(80vh,500px))]":p}),role:"alertdialog","aria-modal":"true","data-testid":"incoming-interaction",children:[(0,r.jsx)("div",{id:St,className:"h-4 shrink-0 cursor-pointer bg-[--c-main-bars-bg]",ref:y}),(0,r.jsx)(ft,{userId:s,className:"flex flex-1 flex-col overflow-hidden py-2"})]})}))}):null}));function jt(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(u){return void n(u)}l.done?t(s):Promise.resolve(s).then(r,o)}function _t(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(l){i=[6,l],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function xt(){var e=(0,L.useModalComponentOpener)(Ot),t=(0,pt.useLocalSettings)(),n=(0,_.useSupervisionUIContext)(["qmViewType","qmUserId","qmModalClose"]),r=n.qmViewType,i=n.qmUserId,a=n.qmModalClose,l=!!i,s=!!a;(0,o.useEffect)((function(){if(l&&"floating"===r&&!s){var n,o,i=(n=function(){var n,r;return _t(this,(function(o){switch(o.label){case 0:return[4,t.get("modals")];case 1:return r=o.sent(),e({position:null==r||null===(n=r.quality_management_monitor)||void 0===n?void 0:n.position}),[2]}}))},o=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){jt(i,r,o,a,l,"next",e)}function l(e){jt(i,r,o,a,l,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)});i()}}),[s,l,t,e,r])}function It(e){var t=e.groups,n=e.columns,r=e.collapsedGroupIds,i=Y();return(0,o.useMemo)((function(){if(t&&0!==t.length){var e,o=n.filter((function(e){return e.sticky})),a=o.filter((function(e){return e.hidden})).length,l=o.length-a,s=0,u=-a,c={content:null,sticky:!0,colspan:l,collapsed:!1,id:void 0};return n.slice(l).reduce((function(n,o,a,l){var c,d=function(){return a===l.length-1},f=function(e){var o=null==t?void 0:t.find((function(t){return e&&t.id===e})),a=i(o),l=null==o?void 0:o.id;u>0&&n.push({content:a,sticky:!1,colspan:u,collapsed:!(!r||!l)&&r[l],id:l})};return o.hidden?(s++,n):(o.groupId===e?(c=d()?s:1,u+=c):(f(e),u=1,e=o.groupId),d()&&f(e),n)}),[c])}}),[r,n,i,t])}var wt=function(e){var t=e.className,n=e.children;return(0,r.jsx)("div",{className:(0,w.B)("flex flex-wrap justify-between",t),children:n})},Ct=function(e){var t=e.title;return(0,r.jsx)("div",{className:"mr-6 mt-2 text-xl font-bold leading-[24px] text-info",children:t})},Nt=function(e){var t=e.serviceId,n=(0,f.useStatsState)().monitoringTeamStats.services,i=(0,X.useLocalizedStatNames)(),a=(0,o.useMemo)((function(){return["name","in_calls_waiting","in_max_wait_time","in_calls_active_on_agents","agents_ready","agents_logged"].map((function(e){return{name:e,title:"name"===e?"":(i[e]||[])[0]||""}}))}),[i]),l=(0,o.useMemo)((function(){return[n[t]].filter(Boolean)}),[t,n]);return(0,r.jsx)(m.ResizeTable,{columns:a,data:l})};function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function At(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||Tt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(e){return function(e){if(Array.isArray(e))return Pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Tt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(e,t){if(e){if("string"==typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pt(e,t):void 0}}var Dt=function(e){var t,n=e.teamId,i=e.className,a=(0,s.useLocalizationState)().t,l=kt((0,o.useState)(""),2),u=l[0],c=l[1],d=kt((0,o.useState)(!1),2),p=d[0],y=d[1],g=(0,f.useStatsState)(["monitoringConfig","teamServicesInfo"]),h=g.monitoringConfig,v=g.teamServicesInfo,S=(0,f.useStatsStateMethods)().changeMonitoringServices,O=(0,o.useCallback)((function(){var e,t=null==h||null===(e=h.configs)||void 0===e?void 0:e.SERVICES_CONFIGS[n];return(null==t?void 0:t.length)?v.filter((function(e){return t.some((function(t){var n=t.id,r=t.v;return n===e.id&&r}))})):[]}),[v,null==h||null===(t=h.configs)||void 0===t?void 0:t.SERVICES_CONFIGS,n]),j=kt((0,o.useState)((function(){return O()})),2),_=j[0],x=j[1],I=kt((0,o.useState)(_.length!==v.length),2),C=I[0],N=I[1];(0,o.useEffect)((function(){x(O())}),[O]),(0,o.useEffect)((function(){N(_.length!==v.length)}),[v.length,_.length]);var P=(0,o.useCallback)((function(){S({teamId:n,services:v.reduce((function(e,t){return At(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Et(e,t,n[t])}))}return e}({},e),Et({},t.id,{visibility:!C||_.some((function(e){return e.id===t.id}))}))}),{})})}),[v,S,C,_,n]),E=(0,o.useMemo)((function(){return v.filter((function(e){return e.name.toLowerCase().includes(u.toLowerCase().trim())}),[])}),[v,u]),A=(0,o.useCallback)((function(e,t){var n=t?Mt(_).concat([e]):_.filter((function(t){return t.id!==e.id}));x(n),N(!!n.length)}),[_]),k=(0,o.useCallback)((function(e){c(e.target.value)}),[c]),M=v.length===_.length,T=(0,o.useCallback)((function(e){x(e?Mt(v):[]),N(e)}),[v]);return v.length?(0,r.jsx)(m.Popup,{show:p,onClickOutside:function(){y(!1),P()},content:(0,r.jsxs)("div",{className:"flex h-80 w-[300px] flex-col overflow-hidden px-0.5 py-px",children:[(0,r.jsx)(m.SearchInput,{autoFocus:!0,value:u,onChange:k}),(0,r.jsxs)("div",{className:"mt-2.5 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"mt-1 text-xs font-bold text-info",children:a.SUPERVISION_PAGE.monitoring_services_filter_services()}),(0,r.jsx)(m.Checkbox,{toggle:!0,checked:C,onChange:function(){return N((function(e){return!e}))},label:a.SUPERVISION_PAGE.monitoring_services_use_filter()})]}),(0,r.jsxs)("div",{className:"mt-4 overflow-y-auto",children:[(0,r.jsx)(m.Checkbox,{checked:M,label:a.SUPERVISION_PAGE.monitoring_services_select_all(),onChange:T}),E.map((function(e){return(0,r.jsx)(m.Checkbox,{className:"mt-2",checked:_.some((function(t){var n=t.id;return e.id===n})),onChange:function(t){return A(e,t)},label:u?(0,m.highlighted)({text:e.name,highlight:u}):e.name},e.id)}))]})]}),children:(0,r.jsx)(m.Button,{transparent:!0,className:(0,w.B)(i,"group"),onClick:function(){return y(!0)},children:C?(0,r.jsx)(b.IconFilterEnabled,{className:"group-hover:[&_path]:fill-primary-hover"}):(0,r.jsx)(b.IconFilterFunnel,{className:"group-hover:[&_path]:fill-primary-hover"})})}):null},Lt=function(e){var t=e.isSelected,n=e.isUntouchedCurrentConfig,o=e.setSelectedView,i=e.name,l=e.configType,s=e.id,u=(0,f.useStatsStateMethods)().deleteTableConfig;return(0,r.jsxs)(a.SmList.Item,{as:"button",className:(0,w.B)("group flex w-full items-center justify-between px-2 py-1",{"font-bold":t,"cursor-default":n}),"aria-disabled":n,onClick:function(){return!n&&o(s)},children:[(0,r.jsxs)("div",{className:"flex w-full items-center",children:[(0,r.jsx)("div",{className:"relative mr-2 w-3",children:n&&(0,r.jsx)(a.SmIcon,{name:"check",color:"grey",className:"w-full"})}),i]}),(0,r.jsx)(m.Button,{transparent:!0,onClick:function(){u(l,s)},className:"invisible flex h-6 w-6 items-center justify-center p-1   opacity-0 transition-all duration-300   group-focus-within:visible group-focus-within:opacity-100   group-hover:visible group-hover:opacity-100   [&_path]:hover:fill-primary-hover [&_path]:focus:fill-primary-hover",children:(0,r.jsx)(b.IconTrash,{})})]},s)};function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ut(e,t,n[t])}))}return e}function Ft(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Bt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var qt=function(e){var t=e.onClose,n=e.table,i=Bt(e,["onClose","table"]),u=Vt((0,o.useState)(""),2),c=u[0],d=u[1],p=(0,s.useLocalizationState)().t,b=(0,K.convertTableTypeToConfig)(n),y=(0,f.useStatsState)((function(e){var t;return null==e||null===(t=e.customConfigs)||void 0===t?void 0:t[b]})),g=(0,f.useStatsState)("monitoringConfig"),h=(0,o.useMemo)((function(){return null==y?void 0:y.find((function(e){return e.id===c}))}),[y,c]),v=(0,f.useStatsStateMethods)().updateMetrics,S=function(){var e=null!=h?h:{},r=e.metrics,o=e.groups;r&&(v({table:n,metrics:r,groups:o,savedConfigOriginId:c}),t())};(0,l.usePressKeyHandler)("Enter",S);var O=(0,o.useMemo)((function(){return null==y?void 0:y.map((function(e){var t,n,r=!!(null==g?void 0:g.additionalData.savedConfigOriginId)&&e.id===g.additionalData.savedConfigOriginId&&(0,x.isEqual)(e.metrics,null==g||null===(t=g.configs)||void 0===t?void 0:t[b])&&(0,x.isEqual)(e.groups,null==g||null===(n=g.additionalData.groups)||void 0===n?void 0:n[b]);return{id:e.id,name:e.name,isUntouchedCurrentConfig:r}}))}),[y,g,b]);return(0,r.jsxs)(m.Modal,Ft(Gt({onClose:t,className:"relative max-w-90 overflow-hidden","aria-labelledby":"save_table_view_modal_title","data-testid":"LoadTableViewModal"},i),{children:[(0,r.jsx)(m.Modal.Header,{role:"heading",id:"save_table_view_modal_title",children:p.SUPERVISION_PAGE.load_table_view()}),(0,r.jsx)(m.Modal.Content,{className:"min-h-[156px] overflow-hidden",children:(0,r.jsx)(a.SmList,{divided:!0,className:"w-full",children:null==O?void 0:O.map((function(e){return(0,r.jsx)(Lt,Gt({isSelected:e.id===c,setSelectedView:d,configType:b},e),e.id)}))})}),(0,r.jsxs)(m.Modal.Actions,{children:[(0,r.jsx)(m.SemanticButton,{onClick:function(){return t()},children:p.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}),(0,r.jsx)(m.SemanticButton,{primary:!0,onClick:S,disabled:!h,children:p.SUPERVISION_PAGE.load()})]})]}))};function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e){var t,n=e.table,r=e.excludedMetrics,i=Y(),a=(t=(0,X.useLocalizedStatNames)(),(0,o.useCallback)((function(e){return e?Ht(null!==(n=t[e.id])&&void 0!==n?n:["",""],1)[0]:"";var n}),[t])),l=(0,f.useTableMetrics)(n),s=(0,f.useTableGroups)(n);return(0,o.useCallback)((function(){return(l||[]).reduce((function(e,t){if(r.includes(t.id))return e;if((0,Z.isSystemMetric)(t)){var n=null==s?void 0:s.find((function(e){return(0,Z.isGroupIndexMetricId)(t,e.id)}));if(!n)throw new Error("Invalid group: ".concat(t.id));return e.push({id:n.id,defaultName:i(n),customName:n.customName,isGroup:!0,columns:[],meta:n}),e}if(t.parentId){var o=e.find((function(e){return e.id===t.parentId}));if(!o||!o.isGroup)throw new Error("Invalid metric: ".concat(t.id));return o.columns.push({id:t.id,defaultName:a(t),customName:t.customName,isGroup:!1,isActive:t.v,meta:t}),e}return e.push({id:t.id,defaultName:a(t),customName:t.customName,isGroup:!1,isActive:t.v,meta:t}),e}),[])}),[r,i,a,s,l])}function Kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $t(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Qt=function(e){var t=e.config,n=e.setConfig,r=(0,l.usePrevious)(t);(0,o.useEffect)((function(){var e=t.filter((function(e){if(e.isGroup||!e.customName)return!1;var t=null==r?void 0:r.find((function(t){return t.id===e.id}));return!t||t.customName!==e.customName}));e.length&&n((function(t){return t.map((function(n){if(n.isGroup)return n;var r=e.find((function(e){return e.id===n.id}));return r&&t.some((function(e){return e.id!==(null==r?void 0:r.id)&&(e.customName===r.customName||e.defaultName===r.customName)}))?$t(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Kt(e,t,n[t])}))}return e}({},n),{customName:void 0}):n}))}))}),[t,r,n])};function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zt(e,t,n[t])}))}return e}function Xt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function en(e){return function(e){if(Array.isArray(e))return Yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function on(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function an(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ln=function(e){var t=e.onClose,n=e.table,i=e.excludedMetrics,a=on(e,["onClose","table","excludedMetrics"]),l=(0,s.useLocalizationState)().t,u=Wt({table:n,excludedMetrics:i}),c=function(e){var t=e.table,n=e.onClose,r=e.excludedMetrics,i=(0,f.useStatsStateMethods)().updateMetrics,a=(0,f.useTableMetrics)(t),l=(0,o.useMemo)((function(){var e=(a||[]).filter((function(e){return r.includes(e.id)}));return e.map((function(e,t){return Xt(Jt({},e),{idx:t})})),e}),[r,a]);return(0,o.useCallback)((function(e){var r=en(l),o=[],a=l[l.length-1].idx,s=0;e.forEach((function(e){if(e.isGroup){var t,n=(0,Z.createGroupId)(),i=n.groupId,l=n.indexMetricId,u=(null===(t=e.meta)||void 0===t?void 0:t.isGroup)?e.meta:void 0,c=null==u?void 0:u.id,d=c||i,f=c?"".concat(c,"_index"):l;return r.push({id:f,idx:a++,v:!1,w:"0px",sW:"0px",parentId:d,isSystem:!0,asc:!0}),o.push(Xt(Jt({},u),{id:d,isGroup:!0,customName:e.customName,idx:s++})),void e.columns.forEach((function(e){var t=e.meta;if(!t||(null==t?void 0:t.isGroup))throw new Error("Invalid child column meta data: ".concat(e.id));r.push(Xt(Jt({},t),{id:e.id,parentId:d,customName:e.customName,idx:a++,v:e.isActive}))}))}var m=e.meta;if(!m||(null==m?void 0:m.isGroup))throw new Error("Invalid column meta data: ".concat(e.id));r.push(Xt(Jt({},m),{id:e.id,customName:e.customName,idx:a++,parentId:void 0,v:e.isActive}))})),i({table:t,metrics:r,groups:o}),n()}),[l,n,t,i])}({table:n,excludedMetrics:i,onClose:t}),d=an((0,o.useState)((function(){return u()})),2),p=d[0],b=d[1];return Qt({config:p,setConfig:b}),(0,r.jsxs)(m.Modal,rn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){nn(e,t,n[t])}))}return e}({flex:!0,onClose:t,className:"relative max-h-[calc(100vh-4rem)] !w-auto max-w-[calc(100vw-4rem)] flex-col overflow-hidden","aria-labelledby":"manage_metrics","data-testid":"manageMetricsModal"},a),{children:[(0,r.jsx)(m.Modal.Header,{id:"manage_metrics",role:"heading",children:l.SUPERVISION_PAGE.manage_metrics_modal_title()}),(0,r.jsx)(m.Modal.Content,{className:"flex flex-auto flex-col overflow-hidden",children:(0,r.jsx)(m.ColumnsEditor,{value:p,onChange:b})}),(0,r.jsxs)(m.Modal.Actions,{children:[(0,r.jsx)(m.SemanticButton,{enabledInOffline:!0,onClick:function(){return t()},"data-testid":"cancel-button",children:l.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}),(0,r.jsx)(m.SemanticButton,{onClick:function(){return c(p)},primary:!0,"data-testid":"ok-button",children:l.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk()})]})]}))};function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function dn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function fn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var mn=function(e){var t=function(e){e.preventDefault(),b({table:i,name:c}),n()},n=e.onClose,i=e.table,l=dn(e,["onClose","table"]),u=fn((0,o.useState)(""),2),c=u[0],d=u[1],p=(0,s.useLocalizationState)().t,b=(0,f.useStatsStateMethods)().saveTableConfig;return(0,r.jsxs)(m.Modal,cn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){un(e,t,n[t])}))}return e}({onClose:n,className:"relative max-w-90 overflow-hidden","aria-labelledby":"save_table_view_modal_title","data-testid":"SaveTableViewModal"},l),{children:[(0,r.jsx)(m.Modal.Header,{role:"heading",id:"save_table_view_modal_title",children:p.SUPERVISION_PAGE.save_table_view()}),(0,r.jsx)(m.Modal.Content,{className:"!flex h-full flex-auto overflow-hidden",children:(0,r.jsx)("form",{onSubmit:t,className:"w-full",children:(0,r.jsxs)(a.SmForm.Field,{className:"w-full",children:[(0,r.jsx)("label",{htmlFor:"save_table_view_modal_input",className:"mb-[9px] block",children:p.SUPERVISION_PAGE.enter_the_view_name()}),(0,r.jsx)(a.SmInput,{fluid:!0,className:"mb-6.5",id:"save_table_view_modal_input",onChange:function(e){d(e.target.value)},value:c})]})})}),(0,r.jsxs)(m.Modal.Actions,{children:[(0,r.jsx)(m.SemanticButton,{onClick:function(){return n()},children:p.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}),(0,r.jsx)(m.SemanticButton,{primary:!0,onClick:t,children:p.WINDOW_POPUP_TITLES_AND_MESSAGES.button_save()})]})]}))};var pn=function(e){var t=e.table,n=e.handleChangeScrolling,i=e.scrollingEnabled,a=e.excludedMetrics,u=(0,s.useLocalizationState)().t,c=(0,l.useBoolean)(),d=c.value,p=c.toggle,y=function(e){var t=e.table,n=e.handleChangeScrolling,r=e.toggleShow,i=e.scrollingEnabled,a=e.excludedMetrics,l=(0,s.useLocalizationState)().t,u=(0,f.useStatsStateMethods)(),c=u.resetMonitoringColumns,d=u.saveMonitoringConfigAsSystem,m=(0,L.useModalComponentOpener)(ln),p=(0,L.useModalComponentOpener)(mn),b=(0,L.useModalComponentOpener)(qt),y=(0,o.useCallback)((function(){m({table:t,excludedMetrics:a})}),[a,m,t]),g=(0,o.useCallback)((function(){p({table:t})}),[p,t]),h=(0,o.useCallback)((function(){b({table:t})}),[b,t]);return(0,o.useMemo)((function(){return[{children:l.SUPERVISION_PAGE.actions_menu_option_manage_metrics(),onClick:(0,x.flow)(y,r)},{children:l.SUPERVISION_PAGE.actions_menu_option_restore_default_view(),onClick:(0,x.flow)((0,x.partial)(c,t),r)},{children:l.SUPERVISION_PAGE.actions_menu_option_set_view(),onClick:(0,x.flow)((0,x.partial)(d,t),r)},{children:i?l.SUPERVISION_PAGE.actions_menu_option_horizontal_scrolling_off():l.SUPERVISION_PAGE.actions_menu_option_horizontal_scrolling_on(),onClick:function(){null==n||n(),r()}},{children:l.SUPERVISION_PAGE.actions_menu_option_save_view(),onClick:(0,x.flow)((0,x.partial)(g,t),r)},{children:l.SUPERVISION_PAGE.actions_menu_option_load_view(),onClick:(0,x.flow)((0,x.partial)(h,t),r)}]}),[l.SUPERVISION_PAGE,y,r,c,t,d,g,h,n,i])}({table:t,handleChangeScrolling:n,scrollingEnabled:i,toggleShow:p,excludedMetrics:a});return(0,r.jsx)(m.PopupButton,{icon:!0,basic:!0,show:d,toggleShow:p,options:y,className:"flex h-9.5 w-9.5 items-center justify-center p-0",tooltip:u.SUPERVISION_PAGE.actions_menu_btn_tooltip(),children:(0,r.jsx)(b.IconTableActions,{})})};function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){yn(e,t,n[t])}))}return e}function hn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Sn=function(e){var t,n,i,a,u=e.teamId,c=e.toggleCollapsedGroup,d=e.collapsedGroupIds,p=(0,s.useLocalizationState)().t,b=(0,L.useModalsStateMethods)().openModal,y=(0,f.useStatsState)(),g=y.monitoringConfig,h=y.monitoringTeamStats,v=h.services,S=h.serviceSummary,O=(0,f.useStatsStateMethods)(),j=O.resizeMonitoringColumns,_=O.updateScrollingState,x=ge(u),I=(0,X.useLocalizedStatNames)(),C=!1!==(null==g||null===(t=g.additionalData.scrolling)||void 0===t?void 0:t.services),N=vn((0,o.useState)(void 0),2),P=N[0],E=N[1],A=(0,o.useCallback)((function(){_({table:"services",scrollingEnabled:!C})}),[C,_]),k=(0,o.useCallback)((function(e){var t=e;return"name"===t?p.MONITORING_SERVICES_COLUMN_NAMES.services_column_name():(I[t]||[""])[0]}),[p.MONITORING_SERVICES_COLUMN_NAMES,I]),M=(0,m.useSorting)(),T=M.sortingSettings,D=M.setSortingSettings,R=M.handleSortingChange,U=(0,o.useMemo)((function(){return[{name:"name",sticky:!0,headerClassName:(0,w.B)("overflow-hidden [&>*>*>button]:absolute [&>*>*>button]:-right-3.5 [&>*>*]:relative [&>*>*]:overflow-visible")}]}),[]),G=ce({config:null==g||null===(n=g.configs)||void 0===n?void 0:n.SERVICES_COLUMN_CONFIGS,extraColumns:U,getColumnTitle:k,sortingSettings:T,setSortingSettings:D,scrollEnabled:C,collapsedGroupIds:d}),F=(0,o.useMemo)((function(){var e,t=(null==g||null===(e=g.configs)||void 0===e?void 0:e.SERVICES_CONFIGS[u])||[];return Object.values(v).map((function(e){return hn(gn({},e),{id:e.service_id||""})})).filter((function(e){return n=e.id,(t.find((function(e){return e.id===n}))||{v:!0}).v;var n}))}),[null==g||null===(i=g.configs)||void 0===i?void 0:i.SERVICES_CONFIGS,v,u]),B=(0,o.useMemo)((function(){return[hn(gn({},S),{id:S.service_id||""})]}),[S]),V=ye({stats:F,sortingSettings:T}),q=(0,o.useCallback)((function(e){return"name"===e.name?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"truncate",children:e.title}),(0,r.jsx)("div",{className:"absolute -right-9.5 top-0",onClick:l.stopPropagation,children:(0,r.jsx)(Dt,{teamId:u})})]}):(0,r.jsx)(r.Fragment,{children:e.title})}),[u]),z=(0,o.useMemo)((function(){return[{id:null,name:p.GLOBAL.no_data()}]}),[p.GLOBAL]),H=ye({stats:B,sortingSettings:T}),W=re(),K=(0,o.useCallback)((function(e){if("string"==typeof e.id){var t=e;b({className:"w-[750px]",title:p.MONITORING_LABEL.monitoring_label_skillsHeader(t.name),body:(0,r.jsx)(Nt,{serviceId:t.id}),afterClose:function(){E(void 0)}}),E(t.id)}}),[b,p.MONITORING_LABEL]),$=(0,o.useCallback)((function(e){j({table:"services",columns:e,scrollEnabled:C})}),[j,C]),Q=(0,o.useMemo)((function(){return[V.findIndex((function(e){return e.id===P}))]}),[V,P]),Y=V.length?V:z,Z=It({groups:null==g||null===(a=g.additionalData.groups)||void 0===a?void 0:a.SERVICES_COLUMN_CONFIGS,columns:G,collapsedGroupIds:d}),J=U.filter((function(e){return e.sticky})).map((function(e){return e.name}));return(0,r.jsxs)("div",{children:[(0,r.jsxs)(wt,{className:"mb-2",children:[(0,r.jsx)(Ct,{title:p.MONITORING_LABEL.monitoring_label_services(x)}),(0,r.jsx)(pn,{scrollingEnabled:C,handleChangeScrolling:A,table:"services",excludedMetrics:J})]}),(0,r.jsx)(m.ResizeTable,{toggleCollapsedGroup:c,renderHeaderItem:q,columns:G,data:Y,footerData:H,sortingSettings:T,renderItem:W,onSortingChange:R,onColumnsResize:$,onRowClick:K,isColumnResizable:!0,isResizable:!0,groups:Z,hasGrid:!0,scrollEnabled:C,selectedRows:Q})]})},On=n(7704),jn=n.n(On),_n=n(4225),xn=n(4593),In=(0,w.B)("group flex cursor-pointer flex-col justify-center","border border-l-4 border-[--supervision-alert-border] border-l-[--supervision-alert-color]","mt-1 h-[53px] w-[316px] bg-white pl-3 pr-1 shadow-md"),wn=function(e){var t=e.agentName,n=e.mediaType,o=e.customerName,i=e.onClose,s=e.onClick,u=e.intentMessage,c=e.timestamp,d=(0,l.useBoolean)(!0);return(0,r.jsx)(a.SmTransition,{visible:d.value,duration:"300",animation:"fade down",onHide:i,unmountOnHide:!0,transitionOnMount:!0,children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{tabIndex:0,role:"alert",className:In,onClick:s,children:[(0,r.jsxs)("div",{className:"flex h-[17px] w-full justify-between",children:[(0,r.jsx)("p",{className:"truncate font-bold text-primary-legacy",children:t}),(0,r.jsx)("p",{className:"shrink-0 group-hover:hidden",children:(0,l.timeFromNow)(c)}),(0,r.jsx)(m.Button,{className:"-mt-1 hidden shrink-0 group-hover:block",onClick:function(e){e.stopPropagation(),d.setFalse()},children:(0,r.jsx)(b.IconClose,{})})]}),(0,r.jsxs)("div",{className:"mt-0.5 flex items-center",children:[(0,r.jsx)(m.InteractionMediaIcon,{icon:(0,xn.mediaTypeToIcon)(n),className:"mr-1 h-4 w-4 [&>path]:fill-icon"}),(0,r.jsx)("span",{className:"font-bold",children:o}),(0,r.jsx)("span",{className:"ml-2",children:u})]})]})})})},Cn=function(e){var t=e.onClose,n=(0,s.useLocalizationState)().t,i=(0,l.useBoolean)(!0);return(0,o.useEffect)((function(){var e=setTimeout((function(){i.setFalse()}),1.3*l.MS_IN_SECOND);return function(){return clearTimeout(e)}}),[i]),(0,r.jsx)(a.SmTransition,{visible:i.value,duration:"300",animation:"fade down",onHide:t,unmountOnHide:!0,transitionOnMount:!0,children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"mt-1 flex h-[31px] w-[254px] items-center justify-between   border border-[--supervision-alert-border] bg-white pl-4 pr-1",role:"alert",children:[(0,r.jsx)("span",{children:n.SUPERVISION_PAGE.no_active_alerts_message()}),(0,r.jsx)(m.Button,{className:"flex",onClick:i.setFalse,children:(0,r.jsx)(b.IconClose,{})})]})})})};function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Pn(e,t,n[t])}))}return e}function An(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function kn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Mn=function(){var e=(0,l.useBoolean)(),t=(0,f.useStatsState)((function(e){return e.intentAlerts.filter((function(e){return!e.closed}))})),n=(0,f.useStatsStateMethods)().closeIntentAlert,i=(0,_.useSupervisionUIContextProducer)(),a=kn((0,o.useState)(null),2),s=a[0],u=a[1],c=kn((0,o.useState)(null),2),d=c[0],p=c[1],y=(0,_.useSupervisionUIContext)(["qmFloatingState","qmWidth"]),g=y.qmFloatingState,h=y.qmWidth,v=(0,_n.usePopper)(s,d,{placement:"bottom-end",modifiers:[{name:"eventListeners",enabled:e.value&&"floating"!==g}]}),S=v.styles,O=v.attributes,j=v.update;(0,o.useEffect)((function(){e.value&&(null==j||j())}),[e.value,g,j]),(0,o.useEffect)((function(){e.value&&"pinned"===g&&(null==j||j())}),[h,e.value,g,j]);var x=(0,o.useMemo)((function(){return t.slice(0,3)}),[t]),I=(0,o.useMemo)((function(){if(s&&"floating"===g){var e=s.getBoundingClientRect();return An(En({},S.popper),{right:h-(window.innerWidth-e.right)+12})}return S.popper}),[S.popper,g,h,s]),C=(0,l.useOnKeyPressHandler)(e.toggle);return(0,r.jsxs)("div",{className:"relative h-9.5 w-9.5",children:[(0,r.jsx)(m.Button,{onClick:e.toggle,onKeyDown:C,ref:u,className:(0,w.B)("group hover:border-[--c-bar-icon-hover]","\n  border border-[--c-main-bars-bg]\n  rounded h-full w-full\n  flex items-center justify-center\n",{"border-transparent bg-[--c-main-bars-bg] hover:border-transparent":e.value}),children:(0,r.jsx)(b.IconBell,{className:(0,w.B)("group-hover:[&_path]:fill-[--c-bar-icon-hover]",{"[&_path]:fill-[--supervision-header-bg]":e.value})})}),(0,r.jsx)(m.UnreadBadge,{unreadAmount:t.length,className:"absolute right-0 top-0   h-3.5 w-3.5 translate-x-1/2   translate-y-1/3 outline   outline-[--supervision-header-bg]"}),e.value&&jn().createPortal((0,r.jsx)("div",An(En({ref:p,className:"z-10",style:I},O.popper),{children:x.length?x.map((function(e){return(0,r.jsx)(wn,En({onClose:function(){n(e.id)},onClick:function(){n(e.id),i((function(t){t.qmUserId=e.userId,t.qmAutofocusedIntentAlert=e,t.qmShowDetails=!0}))}},e),e.id)})):(0,r.jsx)(Cn,{onClose:e.setFalse})})),document.getElementById("root")||window.document.body)]})};function Tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ln(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Rn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Un(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Gn=function(e){var t=function(e){e.preventDefault(),p(g),n()},n=e.onClose,i=Rn(e,["onClose"]),l=(0,s.useLocalizationState)().t,u=(0,f.useStatsState)("intents"),c=u.alerts,d=u.all,p=(0,f.useStatsStateMethods)().setAlertIntents,b=Un((0,o.useState)(c),2),g=b[0],h=b[1],v=(0,o.useMemo)((function(){return d.map((function(e){return{value:e.id,text:e.name}}))}),[d]);return(0,r.jsxs)(m.Modal,Ln(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Dn(e,t,n[t])}))}return e}({onClose:n,flex:!0,className:"relative min-h-[500px] max-w-[540px] flex-col overflow-hidden","aria-labelledby":"alerts_config_modal_title","data-testid":"AlertsConfigModal"},i),{children:[(0,r.jsx)(m.Modal.Header,{role:"heading",id:"save_table_view_modal_title",children:l.SUPERVISION_PAGE.intents_alerts_configuration()}),(0,r.jsx)(m.Modal.Content,{className:"!flex flex-auto overflow-hidden",children:(0,r.jsx)(a.SmForm,{onSubmit:t,className:"w-full",children:(0,r.jsxs)(a.SmForm.Field,{children:[(0,r.jsx)("label",{children:l.SUPERVISION_PAGE.intents_for_alerts_label()}),(0,r.jsx)(a.SmDropdown,{multiple:!0,selection:!0,search:!0,clearable:!0,options:v,value:g,onChange:function(e,t){var n=t.value;Array.isArray(n)&&(0,y.every)(n,(function(e){return"string"==typeof e}))&&h(n)}})]})})}),(0,r.jsxs)(m.Modal.Actions,{children:[(0,r.jsx)(m.SemanticButton,{onClick:function(){return n()},children:l.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}),(0,r.jsx)(m.SemanticButton,{primary:!0,onClick:t,children:l.WINDOW_POPUP_TITLES_AND_MESSAGES.button_save()})]})]}))};function Fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vn(e){if((0,y.isStringifiedNumber)(e))return e;var t=Bn(e.split(":").map(Number),2),n=t[0],r=t[1];return"".concat(60*n+r)}function qn(e,t){return"time"===((0,Z.isNotReadyKey)(e)?"time":Z.thresholdsFormattingMap[e])?(0,l.formatDurationShort)(Number(t)):t}var zn=function(e){var t=e.state,n=e.onClose,i=e.readOnly,a=function(){var e,n={};return null===(e=(0,y.typedKeys)(t))||void 0===e||e.forEach((function(e){if("selectedItem"!==e){var r,o=t[e];(null==o?void 0:o.editMode)&&(n[e]={textColor:(r=o).textColor,backgroundColor:r.backgroundColor,disabled:r.disabled,condition:r.condition,value:Vn(r.value)})}})),n},l=(0,s.useLocalizationState)().t,u=(0,f.useStatsStateMethods)(),c=u.saveThresholdsConfig,d=u.setDefaultSystemThresholds,p=(0,o.useMemo)((function(){var e;return null===(e=(0,y.typedKeys)(t))||void 0===e?void 0:e.some((function(e){if("selectedItem"===e)return!1;var n=t[e];return(null==n?void 0:n.editMode)&&(null==n?void 0:n.invalid)}))}),[t]);return i?(0,r.jsx)(m.Modal.Actions,{children:(0,r.jsx)(m.SemanticButton,{onClick:function(){return n()},primary:!0,children:l.GLOBAL.close()})}):(0,r.jsxs)(m.Modal.Actions,{className:"flex justify-between",children:[(0,r.jsx)(m.SemanticButton,{disabled:p,basic:!0,onClick:function(){p||(d({thresholds:a()}),n())},children:l.THRESHOLDS.threshold_button_setDefault()}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)(m.SemanticButton,{disabled:p,primary:!0,onClick:function(){p||(c({thresholds:a()}),n())},children:l.THRESHOLDS.threshold_button_apply()}),(0,r.jsx)(m.SemanticButton,{onClick:function(){return n()},children:l.GLOBAL.cancel()})]})]})},Hn=i().memo((function(e){var t=e.readOnly,n=(0,s.useLocalizationState)().t;return(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"whitespace-nowrap text-right",children:[(0,r.jsx)("th",{}),(0,r.jsx)("th",{className:"pr-6",children:n.THRESHOLDS.threshold_heading_threshold()}),(0,r.jsx)("th",{className:"pr-2.5",children:n.THRESHOLDS.threshold_color_heading()}),!t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("th",{}),(0,r.jsx)("th",{})]})]})})}));function Wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function $n(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Qn=function(e){var t=e.thresholdItem,n=e.setState,o=$n(e,["thresholdItem","setState"]),i=(0,s.useLocalizationState)().t;return(0,r.jsx)(m.LinkLikeButton,Kn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Wn(e,t,n[t])}))}return e}({},o),{onClick:t.disabled?function(){n(ve()((function(e){e[t.key].disabled=!1})))}:function(){n(ve()((function(e){e[t.key].disabled=!0})))},children:t.disabled?i.THRESHOLDS.enable():i.THRESHOLDS.disable()}))};function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zn(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Jn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Xn=function(e){var t=e.thresholdItem,n=e.systemThreshold,o=e.setState,i=Jn(e,["thresholdItem","systemThreshold","setState"]),a=(0,s.useLocalizationState)().t;if(t.disabled)return null;return(0,r.jsx)(m.LinkLikeButton,Zn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Yn(e,t,n[t])}))}return e}({onClick:t.editMode?function(){o(ve()((function(e){e[t.key].editMode=!t.editMode,e[t.key].value=qn(t.key,n.value)})))}:function(){o(ve()((function(e){e[t.key].editMode=!t.editMode,e[t.key].valueInputAutoFocused=!0})))}},i),{children:t.editMode?a.THRESHOLDS.restore():a.THRESHOLDS.edit()}))},er=n(3966);function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function or(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(e){switch(e){case"red":return"#ff0000";case"transparent":return"#ffffff00";default:return e}}var lr=function(e){var t=e.onClose,n=e.textColor,i=e.bgColor,a=e.onSubmit,l=or(e,["onClose","textColor","bgColor","onSubmit"]),u=(0,s.useLocalizationState)().t,c=ir((0,o.useState)((function(){return ar(n)})),2),d=c[0],f=c[1],p=ir((0,o.useState)((function(){return ar(i)})),2),b=p[0],y=p[1];return(0,r.jsxs)(m.Modal,rr(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){nr(e,t,n[t])}))}return e}({size:"small",onClose:t,"aria-labelledby":"color_modal"},l),{children:[(0,r.jsx)(m.Modal.Header,{id:"color_modal",children:u.SETTINGS.settings_menu_alarmConfiguration()}),(0,r.jsxs)(m.Modal.Content,{className:"flex justify-between gap-12",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{children:u.THRESHOLDS.threshold_config_label_text()}),(0,r.jsx)(er.HexAlphaColorPicker,{className:"w-full",onChange:f,color:d})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{children:u.THRESHOLDS.threshold_config_label_background()}),(0,r.jsx)(er.HexAlphaColorPicker,{className:"w-full",id:"threshold_bg_color",onChange:y,color:b})]})]}),(0,r.jsxs)(m.Modal.Actions,{children:[(0,r.jsx)(m.SemanticButton,{primary:!0,onClick:function(){a({textColorValue:d,bgColorValue:b}),t()},children:u.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk()}),(0,r.jsx)(m.SemanticButton,{onClick:function(){return t()},children:u.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()})]})]}))},sr=function(e){var t=e.thresholdItem,n=e.isSelected,i=e.setState,a=(0,L.useModalComponentOpener)(lr),l=(0,o.useCallback)((function(){var e,n;a({textColor:null!==(e=t.textColor)&&void 0!==e?e:"red",bgColor:null!==(n=t.backgroundColor)&&void 0!==n?n:"transparent",onSubmit:function(e){var n=e.textColorValue,r=e.bgColorValue;i(ve()((function(e){e[t.key].textColor=n,e[t.key].backgroundColor=r})))}})}),[a,i,t.backgroundColor,t.key,t.textColor]);return t.disabled?null:(0,r.jsx)("button",{style:{backgroundColor:t.backgroundColor,color:t.textColor},tabIndex:t.editMode?0:-1,className:(0,w.B)("w-full pr-2.5 text-right",{"hover:cursor-pointer":t.editMode,underline:n&&t.editMode}),onClick:t.disabled||!t.editMode?void 0:l,children:t.value})},ur=function(e){var t,n=e.thresholdItem,i=e.setState,l=e.isSelected,u=(0,s.useLocalizationState)().t,c=(0,o.useCallback)((function(e){switch(e){case"GREAT_THAN":return">";case"LESS_THAN":return"<";default:return""}}),[]),d=(0,o.useCallback)((function(e,t){switch(e){case"AUTO":return u.THRESHOLDS.threshold_condition_auto();case"GREAT_THAN":return"> ".concat(t);case"LESS_THAN":return"< ".concat(t)}}),[u]),f=(0,o.useCallback)((function(){i(ve()((function(e){e[n.key].valueInputAutoFocused=!1})))}),[i,n.key]),m=(0,o.useRef)(null),p=(0,o.useCallback)((function(e){var t=e.target.value;i(ve()((function(e){e[n.key].value=t,!function(e){if(e.match(/[a-zA-Z]/g))return!1;if(!e.includes(":"))return e.match(/^[0-9]*$/g);var t=Bn(e.split(":").map(Number),2),n=t[0],r=t[1];return!isNaN(n)&&!isNaN(r)&&!(n<0||r<0||r>59)}(t)?e[n.key].invalid=!0:delete e[n.key].invalid})))}),[i,n.key]),b=(0,o.useRef)(0);return(0,o.useEffect)((function(){m.current&&(b.current=m.current.offsetWidth)}),[]),n.disabled?null:n.editMode?(0,r.jsx)(r.Fragment,{children:l?(0,r.jsxs)("div",{className:"flex w-full justify-end",children:[(0,r.jsx)("span",{className:"flex items-center",children:c(n.condition)}),(0,r.jsx)(a.SmInput,{className:"!mr-[3px] !mt-px !h-full w-[50px] !p-0 [&>input]:p-0.5 [&>input]:text-right",style:{width:null!==(t=b.current)&&void 0!==t?t:"auto"},value:n.value,error:n.invalid,onBlur:f,autoFocus:n.valueInputAutoFocused,onChange:p})]}):(0,r.jsx)("span",{ref:m,children:d(n.condition,n.value)})}):(0,r.jsx)("span",{ref:m,children:d(n.condition,n.value)})},cr=i().memo((function(e){var t=e.thresholdItem,n=e.systemThreshold,i=e.isSelected,a=e.setState,l=e.readOnly,s=i?"opacity-100":"opacity-0",u=(0,o.useCallback)((function(){a(ve()((function(e){e.selectedItem=t.key})))}),[a,t.key]),c=(0,o.useCallback)((function(){a(ve()((function(e){e.selectedItem=void 0})))}),[a]);return(0,r.jsxs)("tr",{onMouseEnter:u,onFocus:u,tabIndex:0,onMouseLeave:c,className:"h-6.5",children:[(0,r.jsx)("td",{title:t.fullName,className:"pr-16",children:t.name}),(0,r.jsx)("td",{className:"pr-6 text-right",children:(0,r.jsx)(ur,{thresholdItem:t,setState:a,isSelected:i})}),(0,r.jsx)("td",{children:(0,r.jsx)(sr,{thresholdItem:t,setState:a,isSelected:i})}),!l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("td",{children:(0,r.jsx)(Xn,{className:(0,w.B)(s,"pl-2 pr-4"),thresholdItem:t,systemThreshold:n,setState:a})}),(0,r.jsx)("td",{title:t.fullName,children:(0,r.jsx)(Qn,{className:"mx-1",thresholdItem:t,setState:a})})]})]})})),dr=function(e){var t=e.children;return(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,children:(0,r.jsx)("div",{className:"font-bold",children:t})})})},fr=function(e){var t=e.state,n=e.setState,i=e.readOnly,a=(0,s.useLocalizationState)().t,l=(0,f.useStatsState)("systemThresholds"),u=(0,o.useMemo)((function(){var e,n=[],r=[];return null===(e=(0,y.typedKeys)(t))||void 0===e||e.forEach((function(e){"selectedItem"!==e&&(Z.servicesThresholdsKeys.includes(e)?n.push(t[e]):r.push(t[e]))})),{services:n,agents:r}}),[t]);return(0,r.jsx)(m.Modal.Content,{className:"justify-self-center",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)(Hn,{readOnly:i}),(0,r.jsxs)("tbody",{children:[(0,r.jsx)(dr,{children:a.THRESHOLDS.threshold_label_service()}),u.services.map((function(e){return(0,r.jsx)(cr,{thresholdItem:e,isSelected:t.selectedItem===e.key,systemThreshold:l.config[e.key],setState:n,readOnly:i},e.key)})),(0,r.jsx)(dr,{children:a.THRESHOLDS.threshold_label_agents()}),u.agents.map((function(e){return(0,r.jsx)(cr,{thresholdItem:e,isSelected:t.selectedItem===e.key,systemThreshold:l.config[e.key],setState:n,readOnly:i},e.key)}))]})]})})};function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){pr(e,t,n[t])}))}return e}function yr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Or(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function jr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _r=function(e){var t,n,i,a,l,u=e.onClose,d=Or(e,["onClose"]),p=(0,s.useLocalizationState)().t,b=(t=(0,f.useStatsState)(["thresholds","systemThresholds"]),n=t.thresholds,i=t.systemThresholds,a=(0,X.useLocalizedStatNames)(),l=(0,o.useCallback)((function(e){if((0,Z.isNotReadyKey)(e)){var t=(0,Z.notReadyKeyToReason)(e);return{name:t,fullName:t}}var n=gr(e in a?a[e]:[e,e],2);return{name:n[0],fullName:n[1]}}),[a]),(0,o.useMemo)((function(){var e={},t=!0,r=!1,o=void 0;try{for(var a,s=Object.entries(i.config)[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var u=gr(a.value,2),c=u[0],d=u[1];(0,Z.isThresholdKey)(c)&&(e[c]=yr(br({},d,l(c)),{key:c,value:qn(c,d.value),editMode:!1}))}}catch(S){r=!0,o=S}finally{try{t||null==s.return||s.return()}finally{if(r)throw o}}var f=!0,m=!1,p=void 0;try{for(var b,y=Object.entries(n.config)[Symbol.iterator]();!(f=(b=y.next()).done);f=!0){var g=gr(b.value,2),h=g[0],v=g[1];(0,Z.isThresholdKey)(h)&&v&&(e[h]=yr(br({},v,l(h)),{value:qn(h,v.value),key:h,editMode:!0}))}}catch(S){m=!0,p=S}finally{try{f||null==y.return||y.return()}finally{if(m)throw p}}return e}),[l,i,n])),y=!(0,c.useSessionState)("privileges").SYS_ALERT_CONFIG,g=jr((0,o.useState)(b),2),h=g[0],v=g[1];return(0,r.jsxs)(m.Modal,Sr(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vr(e,t,n[t])}))}return e}({onClose:u,className:"max-w-[720px]","aria-labelledby":"alert_configuration"},d),{children:[(0,r.jsx)(m.Modal.Header,{id:"alert_configuration",children:p.SETTINGS.settings_menu_alarmConfiguration()}),(0,r.jsx)(fr,{state:h,setState:v,readOnly:y}),(0,r.jsx)(zn,{onClose:u,state:h,readOnly:y})]}))},xr=function(){var e=(0,s.useLocalizationState)().t,t=(0,l.useBoolean)(),n=(0,L.useModalComponentOpener)(Gn),i=(0,o.useCallback)((function(e){e.preventDefault(),n()}),[n]),a=(0,L.useModalComponentOpener)(_r),u=(0,o.useCallback)((function(e){e.preventDefault(),a()}),[a]),c=(0,l.useOnKeyPressHandler)(t.toggle),d=(0,o.useMemo)((function(){return[{children:e.SUPERVISION_PAGE.metrics_alerts_configuration(),onClick:(0,x.flow)(u,t.setFalse)},{children:e.SUPERVISION_PAGE.intents_alerts_configuration(),onClick:(0,x.flow)(i,t.setFalse)}]}),[i,u,t.setFalse,e.SUPERVISION_PAGE]);return(0,r.jsx)(m.PopupButton,{custom:!0,show:t.value,toggleShow:t.toggle,enabledInOffline:!0,className:"group",popupClassName:"items-center flex",onClick:i,onKeyDown:c,options:d,children:(0,r.jsx)(b.IconSettings,{className:"group-hover:[&>path]:fill-[--c-bar-icon-hover]"})})},Ir=function(){var e=(0,c.useSessionState)("privileges"),t=(0,s.useLocalizationState)().t,n=(0,o.useMemo)((function(){return[{id:"metrics",title:t.MONITORING_LABEL.supervision_teams()}]}),[t]);return(0,r.jsxs)("header",{className:"flex h-[50px] items-center justify-between bg-[--supervision-header-bg] py-1.5 pr-6",children:[(0,r.jsx)(m.Tabs,{tabs:n,activeTabId:"metrics",headerClassName:"bg-transparent border-b-transparent",tabsContentClassName:"hidden"}),e.SYS_VIEW_LIST_OF_AGENTS&&(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsx)(Mn,{}),(0,r.jsx)(xr,{})]})]})};function wr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Nr=function(e){var t,n,i,a=e.teamId,l=e.collapsedGroupIds,u=e.onTeamIdChange,c=e.toggleCollapsedGroup,d=(0,s.useLocalizationState)().t,p=(0,f.useStatsState)(),b=p.monitoringConfig,y=p.monitoringTeamsStats,g=(0,f.useStatsStateMethods)(),h=g.resizeMonitoringColumns,v=g.updateScrollingState,S=(0,X.useLocalizedStatNames)(),O=!1!==(null==b||null===(t=b.additionalData.scrolling)||void 0===t?void 0:t.teams),j=(0,o.useCallback)((function(){v({table:"teams",scrollingEnabled:!O})}),[O,v]),_=(0,o.useCallback)((function(e){var t=e;return"name"===t?d.MONITORING_TEAMS_COLUMN_NAMES.teams_column_name():(S[t]||[""])[0]}),[d.MONITORING_TEAMS_COLUMN_NAMES,S]),x=(0,m.useSorting)(),I=x.sortingSettings,w=x.setSortingSettings,C=x.handleSortingChange,N=(0,o.useMemo)((function(){return[{name:"name",sticky:!0}]}),[]),P=ce({config:null==b||null===(n=b.configs)||void 0===n?void 0:n.TEAMS_COLUMN_CONFIGS,extraColumns:N,getColumnTitle:_,sortingSettings:I,setSortingSettings:w,scrollEnabled:O,collapsedGroupIds:l}),E=(0,o.useMemo)((function(){return Object.values(y).map((function(e){return Cr(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){wr(e,t,n[t])}))}return e}({},e),{id:e.team_id||""})}))}),[y]),A=(0,o.useMemo)((function(){return{id:"",name:d.GLOBAL.all_teams()}}),[d.GLOBAL]),k=ye({stats:E,sortingSettings:I,allItem:A}),M=(0,o.useMemo)((function(){return[k.findIndex((function(e){return e.id===a}))]}),[k,a]),T=re(),D=(0,o.useCallback)((function(e){u(e.id)}),[u]),L=(0,o.useCallback)((function(e){h({table:"teams",columns:e,scrollEnabled:O})}),[h,O]),R=It({groups:null==b||null===(i=b.additionalData.groups)||void 0===i?void 0:i.TEAMS_COLUMN_CONFIGS,columns:P,collapsedGroupIds:l});(0,o.useEffect)((function(){void 0===a&&k.length&&u(k[0].id)}),[a,k]);var U=N.filter((function(e){return e.sticky})).map((function(e){return e.name}));return(0,r.jsxs)("div",{children:[(0,r.jsxs)(wt,{className:"mb-2",children:[(0,r.jsx)(Ct,{title:d.CAMPAIGN_MONITOR.campaignMonitor_teams_heading()}),(0,r.jsx)(pn,{scrollingEnabled:O,table:"teams",handleChangeScrolling:j,excludedMetrics:U})]}),(0,r.jsx)(m.ResizeTable,{toggleCollapsedGroup:c,groups:R,columns:P,data:k,sortingSettings:I,selectedRows:M,renderItem:T,onSortingChange:C,onColumnsResize:L,onRowClick:D,isColumnResizable:!0,isResizable:!0,hasGrid:!0,scrollEnabled:O})]})};function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ar={teams:{},services:{},users:{}};function kr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kr(e,t,n[t])}))}return e}function Tr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Dr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Lr,Rr=i().memo((function(e){var t,n=e.item,o=e.columns,i=e.rowHandlers,a=e.renderItem,l=e.isSelected,s=e.stickyOffsets,u=(0,$.convertKVArray)(null!==(t=n.items)&&void 0!==t?t:{}),c=u.filter((function(e){return e.item_id!==n.active_item_id})).map((function(e){if("object"!=typeof e||!e||!("item_id"in e)||"string"!=typeof e.item_id)throw new Error("Wrong type for item in interaction subrows");return Tr(Mr({},n),{items:Ur(u,e.item_id),active_item_id:e.item_id,active_item_sentiment:"sentiment"in e&&e.sentiment,active_item_service_name:"service_name"in e&&e.service_name,active_item_party_name:"party_name"in e&&e.party_name,active_item_talk_duration:"talk_duration"in e&&e.talk_duration,active_item_hold_duration:"hold_duration"in e&&e.hold_duration,active_item_qm_is_recording:"qm_is_recording"in e&&e.qm_is_recording})})),d=["custom:status","display_name","active_item_sentiment","active_item_talk_duration","active_item_party_name","active_item_service_name","active_item_hold_duration","active_item_qm_is_recording","last_alert"],f=i&&"onClick"in i;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("tr",Tr(Mr({},i),{tabIndex:0,"data-element":"supervision-table-row",className:(0,w.B)({"cursor-pointer":f}),children:[o.map((function(e,t){var o=a(Tr(Mr({},n),{items:c.length>0&&"string"==typeof n.active_item_id?Ur(u,n.active_item_id):n.items}),e),i=o.value,d=o.meta,f=(0,w.B)(e.className,{"!sticky left-0 z-[1]":e.sticky,"bg-table-selected-row-bg":l,"bg-main-bg":!l}),p=s[e.name]?{left:"calc(".concat(s[e.name],")")}:{};return(0,r.jsx)("td",{className:f,style:p,children:(0,r.jsx)(m.TableCell,{style:d,align:e.align,children:i})},"".concat(String(e.name),"-").concat(t))})),(0,r.jsx)("td",{className:(0,w.B)({"bg-table-selected-row-bg":l})},"mock")]})),0!=c.length&&c.map((function(e){return(0,r.jsxs)("tr",{children:[o.map((function(t,n){var o=(0,w.B)("bg-main-bg",t.className,{"opacity-60 [&>div]:pl-4":"display_name"===t.name,"!sticky left-0 z-[1]":t.sticky}),i=s[t.name]?{left:"calc(".concat(s[t.name],")")}:{};return(0,r.jsx)("td",{className:o,style:i,children:(0,r.jsx)(m.TableCell,{align:t.align,children:d.includes(t.name)?a(e,t):null})},"".concat(String(t.name),"-").concat(n))})),(0,r.jsx)("td",{},"mock")]},e.active_item_id)}))]})})),Ur=function(e,t){return(0,$.toKVArray)(e.map((function(e){return Tr(Mr({},e),{intents:e.item_id===t?e.intents:void 0})})))};function Gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Vr={selectedUserIds:[],isEditing:!1,search:"",liveStatsEnabledTime:{}},qr=function(e){var t=e.children,n=Br((0,o.useState)(Vr),2),i=n[0],a=n[1],s=(0,l.useAsRef)(i),u=(0,o.useCallback)((function(e){var t=ve()(s.current,e);s.current=t,a((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Fr(e,t,n[t])}))}return e}({},e,t)}))}),[s]),c=(0,o.useMemo)((function(){return{state:i,produceState:u,stateRef:s}}),[i,u,s]);return Lr||((Lr=(0,Se.createContext)(c)).displayName="UsersTableContext"),(0,r.jsx)(Lr.Provider,{value:c,children:t})},zr=(0,Oe.createUIStateHooks)("UsersTableContext",(function(){return Lr})),Hr=zr.useUsersTableContext,Wr=zr.useUsersTableContextProducer;function Kr(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(u){return void n(u)}l.done?t(s):Promise.resolve(s).then(r,o)}function $r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Kr(i,r,o,a,l,"next",e)}function l(e){Kr(i,r,o,a,l,"throw",e)}a(void 0)}))}}function Qr(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(l){i=[6,l],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}var Yr=function(){var e=Hr(["selectedUserIds","isEditing"]),t=e.selectedUserIds,n=e.isEditing,i=Wr(),a=(0,s.useLocalizationState)().t,l=(0,f.useStatsState)((function(e){var t;return null===(t=e.monitoringConfig)||void 0===t?void 0:t.localData.showSubTeamOnly})),u=(0,f.useStatsState)((function(e){var t;return null===(t=e.monitoringConfig)||void 0===t?void 0:t.additionalData.selectedSubTeamUserIds})),c=(0,f.useStatsStateMethods)(),d=c.setShowSubTeamOnly,p=c.updateSelectedSubTeamUserIds,y=(0,o.useRef)(!1),g=(0,o.useCallback)($r((function(){return Qr(this,(function(e){return l&&(d(!1),y.current=!0),i((function(e){e.selectedUserIds=null!=u?u:[],e.isEditing=!0})),[2]}))})),[i,u,d,l]),h=(0,o.useCallback)((function(){y.current&&(d(!0),y.current=!1)}),[d]),v=(0,o.useCallback)($r((function(){return Qr(this,(function(e){return i((function(e){e.isEditing=!1,e.selectedUserIds=null!=u?u:[]})),h(),[2]}))})),[i,u,h]),S=(0,o.useCallback)((function(){p(t),i((function(e){e.isEditing=!1})),h()}),[i,t,h,p]);return(0,r.jsx)(m.Popup,{show:n,onClick:g,placement:"top-end",contentClassName:"!flex flex-col gap-4 rounded",content:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-xs font-bold text-info",children:a.SUPERVISION_PAGE.monitoring_subTeam_editMode_popupHeader()}),(0,r.jsx)("div",{children:a.SUPERVISION_PAGE.monitoring_subTeam_editMode_popupText()}),(0,r.jsxs)("div",{className:"flex justify-end gap-6",children:[(0,r.jsx)(m.LinkLikeButton,{className:"text-info",onClick:v,children:a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonCancel()}),(0,r.jsx)(m.LinkLikeButton,{onClick:S,children:a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk()})]})]}),children:(0,r.jsx)(m.Button,{className:"group mr-2",children:(0,r.jsx)(b.IconFilterFunnel,{className:"group-hover:[&_path]:fill-primary-hover"})})})},Zr=function(e){var t,n,i=e.allRowsAreFilteredOut,a=(0,s.useLocalizationState)().t,l=(0,f.useStatsState)("monitoringConfig"),u=(0,f.useStatsStateMethods)(),c=u.setIncludeLoggedOut,d=u.setShowSubTeamOnly,p=Hr("isEditing"),b=null!==(n=null==l?void 0:l.localData)&&void 0!==n?n:{},y=b.includeLoggedOut,g=void 0!==y&&y,h=b.showSubTeamOnly,v=void 0!==h&&h,S=!!(null==l||null===(t=l.additionalData.selectedSubTeamUserIds)||void 0===t?void 0:t.length);return(0,o.useEffect)((function(){!i&&S||d(!1)}),[i,d,S]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex shrink-0 items-center",children:[(0,r.jsx)(Yr,{}),(0,r.jsx)(m.Checkbox,{toggle:!0,checked:v,disabled:p||i||!S,onChange:(0,x.unary)(d),label:a.SUPERVISION_PAGE.users_table_my_subteam_only_label(),labelClassName:"pt-0"})]}),(0,r.jsx)(m.Checkbox,{toggle:!0,checked:g,onChange:(0,x.unary)(c),label:a.SUPERVISION_PAGE.users_table_logged_out_users_label(),labelClassName:"pt-0"})]})};function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Xr(e,t,n[t])}))}return e}function to(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function no(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){l=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||oo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ro(e){return function(e){if(Array.isArray(e))return Jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||oo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oo(e,t){if(e){if("string"==typeof e)return Jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jr(e,t):void 0}}var io=function(e){var t,n,i,a,u,c,d=e.teamId,p=e.collapsedGroupIds,g=e.toggleCollapsedGroup,h=(0,s.useLocalizationState)().t,v=(0,f.useStatsState)(["monitoringConfig","monitoringTeamStats"]),S=v.monitoringConfig,O=v.monitoringTeamStats.users,x=(0,f.useStatsStateMethods)(),I=x.resizeMonitoringColumns,w=x.updateScrollingState,C=ge(d),N=(0,X.useLocalizedStatNames)(),P=Hr(["selectedUserIds","isEditing"]),E=P.selectedUserIds,A=P.isEditing,k=Wr(),M=(0,_.useSupervisionUIContextProducer)(),T=Q().getAgentStateIconsProps,D=!1!==(null==S||null===(t=S.additionalData.scrolling)||void 0===t?void 0:t.users),L=(0,o.useCallback)((function(){w({table:"users",scrollingEnabled:!D})}),[D,w]),R=(0,_.useSupervisionUIContext)("qmUserId"),U=no((0,o.useState)([]),2),G=U[0],F=U[1],B=(0,o.useCallback)((function(e){F(ro(G).concat([e]))}),[G]),V=(0,o.useCallback)((function(e){F(G.filter((function(t){return t!==e})))}),[G]),q=(0,o.useCallback)((function(e){return"display_name"===e?h.MONITORING_AGENTS_COLUMN_NAMES.monitoring_column_name():(N[e]||[""])[0]}),[h.MONITORING_AGENTS_COLUMN_NAMES,N]),H=(0,m.useSorting)(),W=H.sortingSettings,K=H.setSortingSettings,$=H.handleSortingChange,Y=(0,o.useMemo)((function(){return[{name:"custom:checkbox",width:"32px",hidden:!A,resizable:!1,sticky:!0,align:"start",className:"[&>*]:px-1",headerClassName:"[&>*]:px-1"},{name:"custom:interactions",width:"28px",hidden:!1,resizable:!1,sticky:!0,align:"start",className:"[&>*]:px-0.5",headerClassName:"[&>*]:px-1"},{name:"custom:status",width:"60px",title:h.SUPERVISION_PAGE.users_table_status_column(),resizable:!1,sticky:!0,align:"start",className:"!align-middle [&>*]:px-1"},{name:"display_name",sticky:!0},{name:"state_duration",sticky:!0},{name:"active_item_sentiment",width:"70px",resizable:!1,sticky:!0,align:"start",className:"[&>*>*]:w-full !align-middle"},{name:"active_item_talk_duration",title:void 0,width:void 0,sticky:!0}]}),[A,h.SUPERVISION_PAGE]),Z=ce({config:null==S||null===(n=S.configs)||void 0===n?void 0:n.USERS_COLUMN_CONFIGS,extraColumns:Y,getColumnTitle:q,sortingSettings:W,setSortingSettings:K,scrollEnabled:D,collapsedGroupIds:p}),J=(0,o.useMemo)((function(){return Object.values(O).map((function(e){return to(eo({},e),{id:e.user_id||""})}))}),[O]),ee=(a=(0,f.useStatsState)((function(e){var t;return null===(t=e.monitoringConfig)||void 0===t?void 0:t.localData.showSubTeamOnly})),u=(0,f.useStatsState)((function(e){var t;return null===(t=e.monitoringConfig)||void 0===t?void 0:t.additionalData.selectedSubTeamUserIds})),(0,o.useCallback)((function(e){return!a||!u||u.includes(e.id)}),[u,a])),te=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),ne=(0,o.useCallback)((function(e,t){if(t&&A)if(e){if(E.includes(t))return;k((function(e){e.selectedUserIds.push(t)}))}else{if(!E.includes(t))return;k((function(e){e.selectedUserIds=E.filter((function(e){return e!==t}))}))}}),[k,E,A]),oe=(0,o.useCallback)((function(e,t){var n=t.name;switch(n){case"custom:checkbox":var o=!!e.user_id&&(null==E?void 0:E.includes(e.user_id));return(0,r.jsx)(m.Checkbox,{checked:o,name:e.user_id,onChange:ne,onClick:te});case"custom:status":var i=no(T(e),2),a=i[0],l=i[1];return(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)(z.AgentStatusIcon,to(eo({isLoggedOut:"0"===e.is_logged},a),{className:"!h-5 !w-5"})),l&&(0,r.jsx)(z.AgentStatusIcon,to(eo({},l),{className:"!h-5 !w-5"}))]});case"custom:interactions":var s=Object.keys((null==e?void 0:e.items)||{}).length||0,u=e.user_id;if((0,y.assertDefined)(u),s<=1)return;var c=G.includes(u);return(0,r.jsxs)("div",{className:"flex h-5 gap-1 truncate",children:[(0,r.jsx)(m.Button,{className:"[&>i]:m-0 [&>i]:w-2",semanticIcon:c?"caret up":"caret down",onClick:function(e){c?V(u):B(u),e.stopPropagation()}}),(0,r.jsx)("span",{children:s})]});default:return null}}),[E,ne,te,T,B,V,G]),ie=Hr("search"),ae=re({customRenderer:oe,search:ie}),le=function(e){var t=Hr("search"),n=Wr(),r=(0,o.useCallback)((function(e){n((function(t){t.search=e.target.value}))}),[n]),i=(0,o.useCallback)((function(){n((function(e){e.search=""}))}),[n]),a=re(),l=(0,o.useDeferredValue)(t);return{handleSearch:r,resetSearch:i,searchFilter:(0,o.useCallback)((function(t){return!l||e.some((function(e){var n=a(t,e).value;return"string"==typeof n&&n.toLowerCase().includes(l.toLowerCase())}))}),[e,a,l])}}(Z),se=le.searchFilter,ue=le.handleSearch,de=le.resetSearch,fe=ye({stats:J,sortingSettings:W,filter:(0,l.combineFilters)([ee,se])}),me=(0,o.useMemo)((function(){return fe.every((function(e){return E.includes(e.id)}))}),[fe,E]),pe=(0,o.useCallback)((function(e){var t=fe.map((function(e){return e.id}));k(e?function(e){e.selectedUserIds=ro(new Set(ro(e.selectedUserIds).concat(ro(t))))}:function(e){e.selectedUserIds=e.selectedUserIds.filter((function(e){return!t.includes(e)}))})}),[fe,k]),be=(0,o.useCallback)((function(e){return"custom:checkbox"===e.name?(0,r.jsx)(m.Checkbox,{checked:me,onChange:pe,onClick:te}):"custom:interactions"===e.name?(0,r.jsx)(b.IconInteraction,{className:"mt-1"}):e.title}),[me,pe,te]),he=J.length>0&&0===fe.length,ve=(0,o.useMemo)((function(){return[fe.findIndex((function(e){return e.id===R}))]}),[fe,R]),Se=(0,o.useCallback)((function(e){var t=e.user_id;t&&M((function(e){e.qmUserId=t}))}),[M]),Oe=(0,o.useCallback)((function(e){I({table:"users",columns:e,scrollEnabled:D})}),[I,D]),je=(c=G,(0,o.useCallback)((function(e){var t=e.item,n=Dr(e,["item"]);return"string"==typeof t.user_id&&c.includes(t.user_id)?(0,r.jsx)(Rr,Mr({item:t},n)):(0,r.jsx)(m.TableRow,Mr({item:t},n))}),[c])),_e=It({groups:null==S||null===(i=S.additionalData.groups)||void 0===i?void 0:i.USERS_COLUMN_CONFIGS,columns:Z,collapsedGroupIds:p}),xe=Y.filter((function(e){return e.sticky})).map((function(e){return e.name}));return(0,r.jsxs)("div",{className:"mt-1 flex min-h-40 flex-auto flex-col overflow-hidden",children:[(0,r.jsxs)(wt,{className:"mb-4 gap-6",children:[(0,r.jsx)(Ct,{title:h.MONITORING_LABEL.monitoring_label_agents(C)}),(0,r.jsxs)("div",{className:"flex flex-1 items-center justify-end gap-6",children:[(0,r.jsx)(m.SearchInput,{value:ie,onChange:ue,placeholder:h.SUPERVISION_PAGE.search_agents(),onClear:de,clearable:!0,className:"basis-[260px]"}),(0,r.jsx)(Zr,{allRowsAreFilteredOut:he}),(0,r.jsx)(pn,{scrollingEnabled:D,table:"users",handleChangeScrolling:L,excludedMetrics:xe})]})]}),(0,r.jsx)(m.ResizeTable,{toggleCollapsedGroup:g,renderCustomRow:je,renderHeaderItem:be,className:j.SUPERVISION_USERS_TABLE.toString(),columns:Z,groups:_e,data:fe,sortingSettings:W,renderItem:ae,onSortingChange:$,onColumnsResize:Oe,onRowClick:A?void 0:Se,isColumnResizable:!A,hasGrid:!0,scrollEnabled:D,selectedRows:ve})]})},ao=function(){var e=(0,f.useStatsState)("monitoringConfig"),t=(0,c.useSessionState)().privileges,n=(0,f.useStatsStateMethods)().setSelectedTeamId,i=null==e?void 0:e.localData.selectedTeamId;xt();var a=function(){var e=Er((0,o.useState)(Ar),2),t=e[0],n=e[1];return(0,pt.useLocalStorageForState)(t,"adSupervisionTablesCollapsedGroupIds",n,Ar),{collapsedGroupIds:t,toggleCollapsedGroup:(0,o.useCallback)((function(e,t){n(ve()((function(n){n[e][t]=!n[e][t]})))}),[])}}(),l=a.collapsedGroupIds,s=a.toggleCollapsedGroup;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ir,{}),(0,r.jsx)("div",{className:"flex grow flex-col overflow-y-auto px-6 py-2","data-testid":"supervision-page",children:e?(0,r.jsxs)(r.Fragment,{children:[t.SYS_VIEW_QUEUE_STATUS&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Nr,{teamId:i,onTeamIdChange:n,collapsedGroupIds:l.teams,toggleCollapsedGroup:(0,x.partial)(s,"teams")}),void 0!==i&&(0,r.jsx)(Sn,{collapsedGroupIds:l.services,toggleCollapsedGroup:(0,x.partial)(s,"services"),teamId:i})]}),t.SYS_VIEW_LIST_OF_AGENTS&&void 0!==i&&(0,r.jsx)(qr,{children:(0,r.jsx)(io,{collapsedGroupIds:l.users,toggleCollapsedGroup:(0,x.partial)(s,"users"),teamId:i})})]}):(0,r.jsx)(m.Loader,{size:"huge",color:"primary",active:!0})})]})}},4483:(e,t,n)=>{n.d(t,{B:()=>a});var r=n(9478),o=n.n(r),i=n(324);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.m6)(o()(t))}}}]);
//# sourceMappingURL=233.5d74abc9.chunk.js.map