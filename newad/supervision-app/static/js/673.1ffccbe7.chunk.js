/*! For license information please see 673.1ffccbe7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk_bpinc_web_supervision_ui=self.webpackChunk_bpinc_web_supervision_ui||[]).push([[673],{7029:(e,n,t)=>{var o=t(7704);n.s=o.createRoot,o.hydrateRoot},1361:(e,n,t)=>{t.r(n);var o=t(2322),i=t(6029),r=t.n(i),s=t(7029),a=t(2850),c=t(3233),l=t(4264),u=t(2488),d=t(801),f=t(4483),_=function(){var e=(0,l.useSupervisionUIContext)("setMainContentNode"),n=(0,u.useUIState)().isTabNavHighlighted;return(0,o.jsxs)("div",{className:(0,f.B)("relative flex h-full justify-items-stretch",{"[&_*:focus-within]:!outline-none [&_*:focus]:!outline-none":!n,"[&_*:focus-within]:!outline-0 [&_*:focus]:!outline-0":!n}),children:[(0,o.jsx)("section",{className:"flex grow flex-col items-stretch overflow-hidden",ref:e,role:"tabpanel",children:(0,o.jsx)(c.PR,{})}),(0,o.jsx)(c.Ui,{}),(0,o.jsx)(d.Modals,{})]})},S=t(7500),h=t(2469),p=t(9022),E=t(6441),m=t(5886),g=t(9008),v=t(7421),b=t(7505),x=t(9717),N=t(9486),w=t(3346),L=new URL("http://localhost:9897");L.searchParams.append("domain",location.hostname);var C=L.toString(),I="bpClient/onShowDomainAuthorizationDialog",O=t(8715),A=t(3650),P="cursor-pointer text-primary-legacy",j="ext-link",D="ext-link-firefox",M="plugin-link",T=function(e){var n=e.isExtAvailable,t=e.install,r=(0,N.useLocalizationState)().t.INSTALLATION_PROCESS,s=(0,A.useInstallationMethods)(),a=s.installChromeExtension,c=s.installFirefoxExtension,l=s.installBPClientPlugin;(0,i.useEffect)((function(){var e=document.getElementById(j),n=document.getElementById(D),t=document.getElementById(M);return null==e||e.addEventListener("click",a),null==n||n.addEventListener("click",c),null==t||t.addEventListener("click",l),function(){null==e||e.removeEventListener("click",a),null==n||n.removeEventListener("click",c),null==t||t.removeEventListener("click",l)}}),[a,c,l]);var u=r.install_updateHeader(M,P);return t&&(u="chrome"===O.platformInfo.browser?n?r.install_installHeader(M,P):r.install_installHeaderChrome(j,M,P):"firefox"===O.platformInfo.browser?n?r.install_installHeader(M,P):r.install_installHeaderFirefox(D,M,P):r.install_installHeader(M,P)),(0,o.jsx)("div",{dangerouslySetInnerHTML:{__html:u}})},y=t(6508),R=t(3764);var k=function(e){var n=e.browserName,t=(0,N.useLocalizationState)("t").INSTALLATION_PROCESS,i=(0,g.useSessionState)("serverOrigin"),r="chrome"===O.platformInfo.browser,s="firefox"===O.platformInfo.browser,a="safari"===O.platformInfo.browser,c="";return r?c=A.URL_EXTENSION_INSTALLER_CHROME:s?c=i+A.URL_EXTENSION_INSTALLER_FIREFOX:a&&(c=i+A.URL_MAC_PLUGIN),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:t.bp_client_old_extension_version(n)}),(r||s||a)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("span",{children:t.bp_client_update_extension_part1()}),(0,o.jsx)("a",{href:c,rel:"noopener noreferrer",target:"_blank",children:t.bp_client_update_extension_text()}),(0,o.jsx)("span",{children:t.bp_client_update_extension_part2()})]})]})},B=t(4432),z=function(){return location.reload()};var W=t(1960),U=5e3;function G(){var e,n,t,r,s,a,c,l,u,d,f,_;e=(0,v.useBpClientStateConnector)(),n=(0,w.useModalsStateMethods)(),t=n.openModal,r=n.closeModal,s=(0,N.useLocalizationState)("t"),a=(0,x.useEvent)((function(){t({id:I,title:s.INSTALLATION_PROCESS.bp_client_not_authorized_header(),body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:s.INSTALLATION_PROCESS.bp_client_not_authorized_message_part1()}),(0,o.jsx)("a",{href:C,rel:"noopener noreferrer",target:"_blank",children:s.ERROR_MESSAGES.domainAuthentificationErrorAnchor()}),(0,o.jsx)("span",{children:s.INSTALLATION_PROCESS.bp_client_not_authorized_message_part2()})]}),actions:function(e){var n=e.closeModal;return(0,o.jsx)(b.SmButton,{onClick:n,children:s.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk()})}})})),c=(0,x.useEvent)((function(){r(I)})),(0,i.useEffect)((function(){return e.dispenser.subscribe({onShowDomainAuthorizationDialog:a,onHideDomainAuthorizationDialog:c}).unsubscribe}),[e,a,c]),function(){var e=(0,N.useLocalizationState)("t").WINDOW_POPUP_TITLES_AND_MESSAGES,n=(0,v.useBpClientState)("isExtensionAvailable"),t=(0,v.useBpClientStateConnector)(),r=(0,w.useModalsStateMethods)().openModal,s=(0,x.useEvent)((function(t){r({title:e.window_title_warning(),body:(0,o.jsx)(T,{install:t,isExtAvailable:n}),actions:{ok:{title:e.window_buttonOk()}}})}));(0,i.useEffect)((function(){return t.dispenser.subscribe({onInstallationRequired:s}).unsubscribe}),[t,s])}(),l=(0,R.useNotificationsState)("methods").showNotification,u=(0,y.useOfflineStateMethods)().setShowOfflineAlert,d=(0,y.useOfflineStateDataShowOfflineAlert)(),f=(0,y.useOfflineErrorMessages)(),_=(0,y.useIsOffline)(),(0,i.useEffect)((function(){d&&l({type:"error",id:R.Notifications.OfflineStateError,content:f.isOffline,closable:!0,duration:5e3,onHide:function(){return u(!1)}})}),[f.isOffline,u,l,d]),(0,i.useEffect)((function(){_||u(!1)}),[_,u]),function(){var e=(0,v.useBpClientStateConnector)(),n=(0,N.useLocalizationState)("t").WINDOW_POPUP_TITLES_AND_MESSAGES,t=(0,w.useModalsStateMethods)().openModal,r=(0,x.useEvent)((function(e){t({title:n.window_title_warning(),body:(0,o.jsx)(k,{browserName:e}),actions:function(e){var t=e.closeModal;return(0,o.jsx)(b.SmButton,{onClick:t,children:n.window_buttonOk()})}})}));(0,i.useEffect)((function(){return e.dispenser.subscribe({onShowExtensionIsOldDialog:r}).unsubscribe}),[e,r])}(),function(){var e=(0,R.useNotificationsState)("methods"),n=e.showNotification,t=e.hideNotificationById,r=(0,B.useAppConfigState)("isClientOutdated"),s=(0,g.useSessionState)("isLoggedIn"),a=(0,N.useLocalizationState)("t").GLOBAL,c=(0,x.useEvent)((function(){s&&(r?n({type:"error",id:R.Notifications.OutdatedClientAppError,message:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:a.reload_confirm_new_msg_part1()}),(0,o.jsx)("a",{href:"#",onClick:z,children:a.reload_confirm_action_button_text()}),(0,o.jsx)("span",{children:a.reload_confirm_new_msg_part2()})]})}):t(R.Notifications.OutdatedClientAppError))}));(0,i.useEffect)((function(){c()}),[r,c])}(),function(){var e=(0,g.useSessionStateConnector)(),n=(0,v.useBpClientState)("isHelperAppInstanceCreated"),t=(0,R.useNotificationsState)("methods"),o=t.showNotification,r=t.hideNotificationById,s=(0,g.useSessionState)("phoneType"),a=(0,N.useLocalizationState)("t"),c=(0,x.useEvent)((function(e){if(e.canDial||"phone_type_none"===s)W.bpLogger.info("SIP phone or external line is in service"),r(R.Notifications.PhoneOutOfServiceError);else{var t;switch(W.bpLogger.warn("SIP phone or external line is out of service"),s){case"phone_type_nailed":t=a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_messages_virtual_phone_not_available();break;case"phone_type_soft_secure":case"phone_type_soft_unsecure":t=n?a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_messages_phone_not_available():a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_messages_helper_app_not_available();break;default:t=a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_messages_phone_not_available()}o({type:"error",id:R.Notifications.PhoneOutOfServiceError,message:t,closable:!1,showDelay:U})}})),l=(0,x.useEvent)((function(e,n){"agentServer"===e&&4===n&&o({type:"warning",id:R.Notifications.PhoneOutOfServiceError,message:a.ERROR_MESSAGES.phoneIsNotRegistered(),closable:!1,showDelay:U})})),u=(0,x.useEvent)((function(){o({type:"warning",id:R.Notifications.PhoneOutOfServiceError,message:a.WINDOW_POPUP_TITLES_AND_MESSAGES.window_messages_3pcc_server_connectionLost(),closable:!1,showDelay:U})})),d=(0,x.useEvent)((function(){r(R.Notifications.PhoneOutOfServiceError)}));(0,i.useEffect)((function(){return e.dispenser.subscribe({onUpdateCapabilities:c,onServerError:l,onThreePCCServerGone:u,onThreePCCServerReady:d}).unsubscribe}),[c,l,u,d,e])}(),function(){var e=(0,R.useNotificationsState)("methods"),n=e.showNotification,t=e.hideNotificationById,o=(0,N.useLocalizationState)("t").WINDOW_POPUP_TITLES_AND_MESSAGES,r=(0,g.useSessionState)("sipServer"),s=(0,x.usePreviousValueRef)(r),a=(0,x.useEvent)((function(){r?t(R.Notifications.SipServerConnectionError):s.current&&n({type:"error",id:R.Notifications.SipServerConnectionError,message:o.window_messages_3pcc_server_connectionLost()})}));(0,i.useEffect)((function(){a()}),[r,a])}(),function(){var e=(0,R.useNotificationsState)("methods"),n=e.showNotification,t=e.hideNotificationById,o=(0,N.useLocalizationState)("t").GLOBAL,r=(0,i.useRef)(0),s=(0,x.useEvent)((function(){0!==r.current||(r.current=(new Date).getTime(),fetch("/",{method:"HEAD",cache:"no-store"}).catch((function(e){return console.error(e)})).finally((function(){var e=(new Date).getTime()-r.current;if(r.current=0,e>800){var i=o.slow_connection();n({type:"error",id:R.Notifications.SlowNetworkConnectionError,message:i}),W.bpLogger.warn("Slow connection detected")}else t(R.Notifications.SlowNetworkConnectionError)})))}));(0,i.useEffect)((function(){var e=setInterval(s,5e3);return function(){return clearInterval(e)}}),[s])}(),function(){var e=(0,R.useNotificationsState)("methods"),n=e.showNotification,t=e.hideNotificationById,r=(0,v.useBpClientState)("isDomainAuthorized"),s=(0,N.useLocalizationState)("t").ERROR_MESSAGES,a=(0,x.useEvent)((function(){r?t(R.Notifications.DomainNotAuthorizedForBPClientError):n({type:"error",id:R.Notifications.DomainNotAuthorizedForBPClientError,closable:!1,message:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:s.domain_authentication_error_part1()}),(0,o.jsx)("a",{href:C,rel:"noopener noreferrer",target:"_blank",children:s.domainAuthentificationErrorAnchor()}),(0,o.jsx)("span",{children:s.domain_authentication_error_part2()})]})})}));(0,i.useEffect)((function(){a()}),[r,a])}()}var F=function(e){var n=e.baseConnectors,t=e.authorizedConnectors,i=e.children;return G(),(0,o.jsx)(o.Fragment,{children:i(n,t)})},H=t(9572),X=t(5100),q=t(7282),V=t(6622),J=t(9464),K=t(4778),Q=function(){var e=(0,g.useSessionState)("forceLogoutInfo"),n=(0,g.useSessionStateMethods)().closeForceLogout,t=(0,q.useFormatting)().formatFullName,i=(0,N.useLocalizationState)().t;(0,K.assertDefined)(e);var r=t(e.firstName,e.lastName),s=(0,V.formatDate)(e.timestamp);return(0,o.jsx)(b.SmSegment,{padded:!0,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2   overflow-hidden rounded-none border-none bg-transparent shadow-none",id:"login",children:(0,o.jsxs)(E.Modal,{isOpen:!0,size:"small",className:"max-w-[570px]","aria-describedby":"forceLogoutDialogDescription","data-testid":"forced-logout-modal",children:[(0,o.jsx)(E.Modal.Header,{children:i.WINDOW_POPUP_TITLES_AND_MESSAGES.window_title_information()}),(0,o.jsx)(E.Modal.Content,{children:(0,o.jsx)(E.Modal.Description,{id:"forceLogoutDialogDescription",children:(0,o.jsx)("p",{children:function(){switch(e.errorCode){case J.incomingErrorMessageCodes.forced_logout_by_another_session:return i.ERROR_MESSAGES.sessionWasOverwritten();case J.incomingErrorMessageCodes.forced_logout_by_supervisor:return i.ERROR_MESSAGES.forcedLogout(r,s);case J.incomingErrorMessageCodes.forced_logout_by_disabling_tenant:case J.incomingErrorMessageCodes.forced_logout_by_disabling_user:return i.ERROR_MESSAGES.account_has_been_disabled()}return e.forceLogoutReason}()})})}),(0,o.jsx)(E.Modal.Actions,{children:(0,o.jsx)(b.SmButton,{onClick:n,primary:!0,"data-testid":"ok-button",children:i.WINDOW_POPUP_TITLES_AND_MESSAGES.window_buttonOk()})})]})})},Y=function(){var e=(0,H.useCurrentTabRole)(),n=(0,g.useSessionState)(["authChecked","isLoggedIn","showLoginDialog","offerForceLogin","forceLogoutInfo"]),t=n.authChecked,i=n.isLoggedIn,r=n.showLoginDialog,s=n.offerForceLogin,a=n.forceLogoutInfo,c=!(0,N.useLocalizationState)("language")||"undecided"===e&&!t,l=!c&&(r||!i),u=!!a&&l,d=s&&!a&&l;return(0,o.jsxs)("div",{className:"mx-auto h-full w-[496px]",children:[c&&(0,o.jsx)(E.Loader,{active:!0,size:"huge",color:"primary"}),l&&(0,o.jsx)(X.LoginPage,{}),u&&(0,o.jsx)(Q,{}),d&&(0,o.jsx)(X.ForceLogin,{})]})},Z=r().memo((function(e){var n=e.baseConnectors,t=e.children;return(0,g.useSessionState)("isLoggedIn")?(0,o.jsx)(m.AuthorizedProviders,{baseConnectors:n,children:function(e){return(0,o.jsx)(F,{baseConnectors:n,authorizedConnectors:e,children:t})}}):(0,o.jsx)(Y,{})})),$=t(1980),ee=function(e){var n=e.baseConnectors,t=e.children,i=e.BaseConnectorsConsumer;return i?(0,o.jsx)(i,{baseConnectors:n,children:t}):t},ne=function(e){var n=e.app,t=e.platformSpecific,i=e.BaseConnectorsConsumer,r=e.children;return(0,o.jsx)(m.BaseProviders,{platformSpecific:t,app:n,children:function(e){return(0,o.jsx)(ee,{baseConnectors:e,BaseConnectorsConsumer:i,children:(0,o.jsx)($.Tooltip.Provider,{children:(0,o.jsx)(R.NotificationsStateProvider,{children:r(e)})})})}})},te=function(e){var n=e.app,t=e.platformSpecific,i=e.children,r=e.BaseConnectorsConsumer,s=e.className,a=e.appRemoteName;return(0,o.jsx)(E.AppStyleSelector,{app:a,children:(0,o.jsx)("div",{className:(0,f.B)("h-full",s),children:(0,o.jsx)(ne,{app:n,platformSpecific:t,BaseConnectorsConsumer:r,children:function(e){return(0,o.jsx)(Z,{baseConnectors:e,children:i})}})})})},oe=(0,x.createProviderWrapper)([u.UIContextProvider,l.SupervisionUIContextProvider]),ie=function(){return(0,o.jsx)(te,{platformSpecific:(0,p.createPlatformSpecific)("asu"),app:"asu",appRemoteName:"supervision",children:function(){return(0,o.jsx)(S.DndProvider,{backend:h.HTML5Backend,children:(0,o.jsx)(oe,{children:(0,o.jsx)(_,{})})})}})};t(7445);(0,a.registerServiceWorker)(),(0,s.s)(document.getElementById("root")).render((0,o.jsx)(ie,{}))}}]);
//# sourceMappingURL=673.1ffccbe7.chunk.js.map